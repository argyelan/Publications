#+PROPERTY: header-args :eval never-export
#+TITLE: Statistics, figures and tables
#+OPTIONS: num:nil tol:2
# -*- org-confirm-babel-evaluate: nil -*-
* Final Analysis                
*** Calculating 
**** Initializing, we use all data N=156, but 5 Volumes missing, N=151
#+BEGIN_SRC R :session ECTanal
  fd<-read.csv('~/fd.csv')
  library(ggplot2)
  ggplot(data=fd,aes(x=Site.1,y=madrs_hdrs_percentage_cahnge))+
    geom_boxplot()+
    geom_point()
  #ind.fd<-which(fd$madrs_hdrs_percentage_cahnge> (-5))
  ind.fd<-which(!is.na(fd$Right.Amygdala.baseline.3))
  length(ind.fd)
  myroi.names<-colnames(fd)[grep("EF_",colnames(fd))][c(5:9,12:14,16:17,24:32,44:76,79:111)]
  myvol.names<-c()
  for (j in myroi.names)
  {
    myvol.names<-c(myvol.names,colnames(fd)[grep('volumechange_',colnames(fd))][grep(strsplit(j,'EF_')[[1]][2],colnames(fd)[grep('volumechange_',colnames(fd))])])
  }
  varnames<-data.frame(myroi.names,myvol.names)

  #MECTA
  length(which(fd$ect_device.1[ind.fd]==1))
  #THYMATRON
  length(which(fd$ect_device.1[ind.fd]==2))
  ##sites per device
  ggplot(data=fd[ind.fd,],aes(x=Site.1,y=ect_device.1))+
      geom_point()

  # medication

  #medication free
  length(which(fd$antidepressants.1[ind.fd]==0))

  #SSRI
  length(which(fd$antidepressants.1[ind.fd]==1))

  #SNRI
  length(which(fd$antidepressants.1[ind.fd]==2))

  #TCA
  length(which(fd$antidepressants.1[ind.fd]==3))

  #MAOI
  length(which(fd$antidepressants.1[ind.fd]==4))

  #MISC
  length(which(fd$antidepressants.1[ind.fd]==5))

  ind.ch<-which(fd$antidepressants.3[ind.fd]-fd$antidepressants.1[ind.fd]!=0)
  cbind(fd$antidepressants.1[ind.ch],fd$antidepressants.3[ind.ch])
  ggplot(data=fd[ind.fd,],aes(x=Site.1,y=antidepressants.1))+
      geom_point()

  fd$antidepressants.3[ind.fd]
#+END_SRC

#+RESULTS:
| EF_Left.Cerebellum.Cortex          | volumechange_Left.Cerebellum.Cortex          |
| EF_Left.Thalamus.Proper            | volumechange_Left.Thalamus.Proper            |
| EF_Left.Caudate                    | volumechange_Left.Caudate                    |
| EF_Left.Putamen                    | volumechange_Left.Putamen                    |
| EF_Left.Pallidum                   | volumechange_Left.Pallidum                   |
| EF_Brain.Stem                      | volumechange_Brain.Stem                      |
| EF_Left.Hippocampus                | volumechange_Left.Hippocampus                |
| EF_Left.Amygdala                   | volumechange_Left.Amygdala                   |
| EF_Left.Accumbens.area             | volumechange_Left.Accumbens.area             |
| EF_Left.VentralDC                  | volumechange_Left.VentralDC                  |
| EF_Right.Cerebellum.Cortex         | volumechange_Right.Cerebellum.Cortex         |
| EF_Right.Thalamus.Proper           | volumechange_Right.Thalamus.Proper           |
| EF_Right.Caudate                   | volumechange_Right.Caudate                   |
| EF_Right.Putamen                   | volumechange_Right.Putamen                   |
| EF_Right.Pallidum                  | volumechange_Right.Pallidum                  |
| EF_Right.Hippocampus               | volumechange_Right.Hippocampus               |
| EF_Right.Amygdala                  | volumechange_Right.Amygdala                  |
| EF_Right.Accumbens.area            | volumechange_Right.Accumbens.area            |
| EF_Right.VentralDC                 | volumechange_Right.VentralDC                 |
| EF_ctx.lh.bankssts                 | volumechange_ctx.lh.bankssts                 |
| EF_ctx.lh.caudalanteriorcingulate  | volumechange_ctx.lh.caudalanteriorcingulate  |
| EF_ctx.lh.caudalmiddlefrontal      | volumechange_ctx.lh.caudalmiddlefrontal      |
| EF_ctx.lh.cuneus                   | volumechange_ctx.lh.cuneus                   |
| EF_ctx.lh.entorhinal               | volumechange_ctx.lh.entorhinal               |
| EF_ctx.lh.fusiform                 | volumechange_ctx.lh.fusiform                 |
| EF_ctx.lh.inferiorparietal         | volumechange_ctx.lh.inferiorparietal         |
| EF_ctx.lh.inferiortemporal         | volumechange_ctx.lh.inferiortemporal         |
| EF_ctx.lh.isthmuscingulate         | volumechange_ctx.lh.isthmuscingulate         |
| EF_ctx.lh.lateraloccipital         | volumechange_ctx.lh.lateraloccipital         |
| EF_ctx.lh.lateralorbitofrontal     | volumechange_ctx.lh.lateralorbitofrontal     |
| EF_ctx.lh.lingual                  | volumechange_ctx.lh.lingual                  |
| EF_ctx.lh.medialorbitofrontal      | volumechange_ctx.lh.medialorbitofrontal      |
| EF_ctx.lh.middletemporal           | volumechange_ctx.lh.middletemporal           |
| EF_ctx.lh.parahippocampal          | volumechange_ctx.lh.parahippocampal          |
| EF_ctx.lh.paracentral              | volumechange_ctx.lh.paracentral              |
| EF_ctx.lh.parsopercularis          | volumechange_ctx.lh.parsopercularis          |
| EF_ctx.lh.parsorbitalis            | volumechange_ctx.lh.parsorbitalis            |
| EF_ctx.lh.parstriangularis         | volumechange_ctx.lh.parstriangularis         |
| EF_ctx.lh.pericalcarine            | volumechange_ctx.lh.pericalcarine            |
| EF_ctx.lh.postcentral              | volumechange_ctx.lh.postcentral              |
| EF_ctx.lh.posteriorcingulate       | volumechange_ctx.lh.posteriorcingulate       |
| EF_ctx.lh.precentral               | volumechange_ctx.lh.precentral               |
| EF_ctx.lh.precuneus                | volumechange_ctx.lh.precuneus                |
| EF_ctx.lh.rostralanteriorcingulate | volumechange_ctx.lh.rostralanteriorcingulate |
| EF_ctx.lh.rostralmiddlefrontal     | volumechange_ctx.lh.rostralmiddlefrontal     |
| EF_ctx.lh.superiorfrontal          | volumechange_ctx.lh.superiorfrontal          |
| EF_ctx.lh.superiorparietal         | volumechange_ctx.lh.superiorparietal         |
| EF_ctx.lh.superiortemporal         | volumechange_ctx.lh.superiortemporal         |
| EF_ctx.lh.supramarginal            | volumechange_ctx.lh.supramarginal            |
| EF_ctx.lh.frontalpole              | volumechange_ctx.lh.frontalpole              |
| EF_ctx.lh.temporalpole             | volumechange_ctx.lh.temporalpole             |
| EF_ctx.lh.transversetemporal       | volumechange_ctx.lh.transversetemporal       |
| EF_ctx.rh.bankssts                 | volumechange_ctx.rh.bankssts                 |
| EF_ctx.rh.caudalanteriorcingulate  | volumechange_ctx.rh.caudalanteriorcingulate  |
| EF_ctx.rh.caudalmiddlefrontal      | volumechange_ctx.rh.caudalmiddlefrontal      |
| EF_ctx.rh.cuneus                   | volumechange_ctx.rh.cuneus                   |
| EF_ctx.rh.entorhinal               | volumechange_ctx.rh.entorhinal               |
| EF_ctx.rh.fusiform                 | volumechange_ctx.rh.fusiform                 |
| EF_ctx.rh.inferiorparietal         | volumechange_ctx.rh.inferiorparietal         |
| EF_ctx.rh.inferiortemporal         | volumechange_ctx.rh.inferiortemporal         |
| EF_ctx.rh.isthmuscingulate         | volumechange_ctx.rh.isthmuscingulate         |
| EF_ctx.rh.lateraloccipital         | volumechange_ctx.rh.lateraloccipital         |
| EF_ctx.rh.lateralorbitofrontal     | volumechange_ctx.rh.lateralorbitofrontal     |
| EF_ctx.rh.lingual                  | volumechange_ctx.rh.lingual                  |
| EF_ctx.rh.medialorbitofrontal      | volumechange_ctx.rh.medialorbitofrontal      |
| EF_ctx.rh.middletemporal           | volumechange_ctx.rh.middletemporal           |
| EF_ctx.rh.parahippocampal          | volumechange_ctx.rh.parahippocampal          |
| EF_ctx.rh.paracentral              | volumechange_ctx.rh.paracentral              |
| EF_ctx.rh.parsopercularis          | volumechange_ctx.rh.parsopercularis          |
| EF_ctx.rh.parsorbitalis            | volumechange_ctx.rh.parsorbitalis            |
| EF_ctx.rh.parstriangularis         | volumechange_ctx.rh.parstriangularis         |
| EF_ctx.rh.pericalcarine            | volumechange_ctx.rh.pericalcarine            |
| EF_ctx.rh.postcentral              | volumechange_ctx.rh.postcentral              |
| EF_ctx.rh.posteriorcingulate       | volumechange_ctx.rh.posteriorcingulate       |
| EF_ctx.rh.precentral               | volumechange_ctx.rh.precentral               |
| EF_ctx.rh.precuneus                | volumechange_ctx.rh.precuneus                |
| EF_ctx.rh.rostralanteriorcingulate | volumechange_ctx.rh.rostralanteriorcingulate |
| EF_ctx.rh.rostralmiddlefrontal     | volumechange_ctx.rh.rostralmiddlefrontal     |
| EF_ctx.rh.superiorfrontal          | volumechange_ctx.rh.superiorfrontal          |
| EF_ctx.rh.superiorparietal         | volumechange_ctx.rh.superiorparietal         |
| EF_ctx.rh.superiortemporal         | volumechange_ctx.rh.superiortemporal         |
| EF_ctx.rh.supramarginal            | volumechange_ctx.rh.supramarginal            |
| EF_ctx.rh.frontalpole              | volumechange_ctx.rh.frontalpole              |
| EF_ctx.rh.temporalpole             | volumechange_ctx.rh.temporalpole             |
| EF_ctx.rh.transversetemporal       | volumechange_ctx.rh.transversetemporal       |
I have checked results without obvious two outliers, but no difference. 
#r/o EM and ZV outliers
#ind.fd<-which(fd$madrs_hdrs_percentage_cahnge> (-0.25))

**** Calculating \Delta Volume ~ EF + Age + ECTnumber + Site
#+BEGIN_SRC R :session ECTanal
  myres1v3.s<-matrix(NA,length(myroi.names),6)
  for (i in 1:dim(varnames)[1])
  {
   ef<-fd[ind.fd,grep(varnames[i,1],colnames(fd))]
   dvol<-fd[ind.fd,grep(varnames[i,2],colnames(fd))]
   lm.1<-lm(dvol~ef+Age.1+rul_number.1+Site.1,data=fd[ind.fd,])
   res<-summary(lm.1)
   myres1v3.s[i,1]<-res$coefficients[2,3]
   myres1v3.s[i,2]<-res$coefficients[2,4]
   myres1v3.s[i,3]<-res$coefficients[3,3]
   myres1v3.s[i,4]<-res$coefficients[3,4]
   myres1v3.s[i,5]<-res$coefficients[4,3]
   myres1v3.s[i,6]<-res$coefficients[4,4]
  }

  kiir<-data.frame(myroi.names,myres1v3.s)
  colnames(kiir)<-c('roi','tef','pef','tAge','pAge','tECTnum','pECTnum')
  write.csv(kiir, '/nethome/amiklos/argyelan@gmail.com/projects/ECT/Bergen/ECTEF_collaboration/RULcorrelation/N156_Vol-EF+Age+ECTnum+Site.csv')

  mytable<-data.frame(myroi.names,myres1v3.s)
  fdr<-p.adjust(myres1v3.s[,2],method = 'fdr')#Benjamini & Hochberg 1995 FDR
  #by<-p.adjust(myres1v3[,2],method = 'fdr')#Benjamini & Yekutieli 2001 FDR
  holm<-p.adjust(myres1v3.s[,2],method = 'holm')#Holm 1979 very strict FWE
  fdr.res<-data.frame(mytable, fdr, holm)

  colnames(fdr.res)<-c('roi','t_EF','p_EF','t_Age','p_Age','t_ECTnum','p_ECTnum','BH^EF_FDR','Holm^EF_FWE')
  write.csv(fdr.res, '/nethome/amiklos/argyelan@gmail.com/projects/ECT/Bergen/ECTEF_collaboration/RULcorrelation/N151_dVol-EF+Age+ECTnum+Site_FDRcorrect.csv')

#+END_SRC

#+RESULTS:

**** Calculating \Delta MADRS ~ \Delta Volume + Age + ECTnum + Site
#+BEGIN_SRC R :session ECTanal
myres2v3.s<-matrix(NA,length(myroi.names),6)
for (i in 1:dim(varnames)[1])
{
  ef<-fd[ind.fd,grep(varnames[i,1],colnames(fd))]
  dvol<-fd[ind.fd,grep(varnames[i,2],colnames(fd))]
  lm.1<-lm(madrs_hdrs_percentage_cahnge~dvol+Age.1+rul_number.1+Site.1,data=fd[ind.fd,])
  #lm.1<-lm(madrs_hdrs_percentage_cahnge~ef,data=fd[ind.fd,])
  res<-summary(lm.1)
  myres2v3.s[i,1]<-res$coefficients[2,3]
  myres2v3.s[i,2]<-res$coefficients[2,4]
  myres2v3.s[i,3]<-res$coefficients[3,3]
  myres2v3.s[i,4]<-res$coefficients[3,4]
  myres2v3.s[i,5]<-res$coefficients[4,3]
  myres2v3.s[i,6]<-res$coefficients[4,4]
}
kiir<-data.frame(myroi.names,myres2v3.s)
colnames(kiir)<-c('roi','tvol','pvol','tAge','pAge','tECTnum','pECTnum')
write.csv(kiir, '/nethome/amiklos/argyelan@gmail.com/projects/ECT/Bergen/ECTEF_collaboration/RULcorrelation/N156_dMADRSperc-dVol+Age+ECTnum+Site.csv')

#does not need to do FDR (unfortunatelly)

#+END_SRC
#+RESULTS:
We did not expect too much here given Oltedal et al. 2018.

**** Calculating \Delta MADRS ~ EF + Age + ECTnumber + Site
#+BEGIN_SRC R :session ECTanal
myres3v3.s<-matrix(NA,length(myroi.names),6)
for (i in 1:dim(varnames)[1])
{
  ef<-fd[ind.fd,grep(varnames[i,1],colnames(fd))]
  dvol<-fd[ind.fd,grep(varnames[i,2],colnames(fd))]
  lm.1<-lm(madrs_hdrs_percentage_cahnge~ef+Age.1+rul_number.1+Site.1,data=fd[ind.fd,])
  #lm.1<-lm(madrs_hdrs_percentage_cahnge~ef,data=fd[ind.fd,])
  res<-summary(lm.1)
  myres3v3.s[i,1]<-res$coefficients[2,3]
  myres3v3.s[i,2]<-res$coefficients[2,4]
  myres3v3.s[i,3]<-res$coefficients[3,3]
  myres3v3.s[i,4]<-res$coefficients[3,4]
  myres3v3.s[i,5]<-res$coefficients[4,3]
  myres3v3.s[i,6]<-res$coefficients[4,4]
}
kiir<-data.frame(myroi.names,myres3v3.s)
colnames(kiir)<-c('roi','tef','pef','tAge','pAge','tECTnum','pECTnum')
write.csv(kiir, '/nethome/amiklos/argyelan@gmail.com/projects/ECT/Bergen/ECTEF_collaboration/RULcorrelation/N156_dMADRS-EF+Age+ECTnum+Site.csv')

#does not need to do FDR (unfortunatelly)
#+END_SRC

#+RESULTS:
Interestingly no results here either. I did the whole analysis with
BaselineTotalBrain volume as control for confound, very similar results. (as
expected since age correlates with TotBrainVolume pretty much)

**** Calculating \Delta MADRS ~ EF * \Delta Volume + Age + ECTnumber + Site
#+BEGIN_SRC R :session ECTanal
  myres3v3.si<-matrix(NA,length(myroi.names),6)
  for (i in 1:dim(varnames)[1])
  {
    ef<-fd[ind.fd,grep(varnames[i,1],colnames(fd))]
    dvol<-fd[ind.fd,grep(varnames[i,2],colnames(fd))]
    lm.1<-lm(madrs_hdrs_percentage_cahnge~ef*dvol+Age.1+rul_number.1+Site.1,data=fd[ind.fd,])
    #lm.1<-lm(madrs_hdrs_percentage_cahnge~ef,data=fd[ind.fd,])
    res<-summary(lm.1)
    myres3v3.si[i,1]<-res$coefficients[2,3]
    myres3v3.si[i,2]<-res$coefficients[2,4]
    myres3v3.si[i,3]<-res$coefficients[3,3]
    myres3v3.si[i,4]<-res$coefficients[3,4]
    myres3v3.si[i,5]<-res$coefficients[12,3]
    myres3v3.si[i,6]<-res$coefficients[12,4]
  }
  kiir<-data.frame(myroi.names,myres3v3.si)
  colnames(kiir)<-c('roi','tef','pef','tdVol','pdVol','tINT','pINT')
  write.csv(kiir, '/nethome/amiklos/argyelan@gmail.com/projects/ECT/Bergen/ECTEF_collaboration/RULcorrelation/N156_dMADRS-EFmuldVOL+Age+ECTnum+Site.csv')

  #does not need to do FDR (unfortunatelly)
#+END_SRC

#+RESULTS:
Interestingly no results here either. I did the whole analysis with
BaselineTotalBrain volume as control for confound, very similar results. (as
expected since age correlates with TotBrainVolume pretty much)

**** Calculating volumetric changes: one sample t-test
#+BEGIN_SRC R :session ECTanal
#volumetric changes
#one sample t-test
myres4v3<-matrix(NA,length(myroi.names),4)
for (i in 1:dim(varnames)[1])
{
  ef<-fd[ind.fd,grep(varnames[i,1],colnames(fd))]
  dvol<-fd[ind.fd,grep(varnames[i,2],colnames(fd))]
  lm.1<-lm(madrs_hdrs_percentage_cahnge~ef+Age.1+rul_number.1,data=fd[ind.fd,])
  #lm.1<-lm(madrs_hdrs_percentage_cahnge~ef,data=fd[ind.fd,])
  res<-t.test(dvol)
  myres4v3[i,1]<-res$statistic
  myres4v3[i,2]<-res$p.value
  myres4v3[i,3]<-res$estimate
  myres4v3[i,4]<-res$estimate/sd(dvol,na.rm=TRUE)
}
kiir<-data.frame(myroi.names,myres4v3,p.adjust(myres4v3[,2],method = 'fdr'))
colnames(kiir)<-c('roi','t','p','mean','d','BH_FDR')
write.csv(kiir, '/nethome/amiklos/argyelan@gmail.com/projects/ECT/Bergen/ECTEF_collaboration/RULcorrelation/N156_dVOL_one_sample_t.csv')


#+END_SRC

#+RESULTS:

**** Calculating pairwise volumetric changes between R and L and Figure between R and L
#+BEGIN_SRC R :session ECTanal
   myres5v3<-matrix(NA,floor(length(myroi.names)/2),6)
   ind.to.go.through<-c(1:5,7:10,20:52)
   library(stringr)
   m<-0
   for (i in ind.to.go.through)
   {
     m<-m+1
     if (length(grep('_Left',myroi.names[i]))==1)
     {
       rside<-str_replace(myroi.names[i],'_Left','_Right')
     } else if (length(grep('.lh.',myroi.names[i]))==1)
     {
       rside<-str_replace(myroi.names[i],'.lh.','.rh.')
     }
     j<-which(myroi.names==rside)
     dvol.r<-fd[ind.fd,grep(varnames[j,2],colnames(fd))]
     dvol.l<-fd[ind.fd,grep(varnames[i,2],colnames(fd))]
     res<-t.test(dvol.r,dvol.l,paired = TRUE)
     res.l<-t.test(dvol.l)
     res.r<-t.test(dvol.r)

     myres5v3[m,1]<-res$statistic
     myres5v3[m,2]<-res$p.value
     myres5v3[m,3]<-res$estimate
     myres5v3[m,4]<-res$estimate/sd(dvol.r-dvol.l,na.rm=TRUE)
     myres5v3[m,5]<-res.l$estimate/sd(dvol.l,na.rm=TRUE)
     myres5v3[m,6]<-res.r$estimate/sd(dvol.r,na.rm=TRUE)

   }
   kiir<-data.frame(myroi.names[ind.to.go.through],myres5v3,p.adjust(myres5v3[,2],method = 'fdr'))
   colnames(kiir)<-c('roi','t','p','mean','d','d_l','d_r','BH_FDR')
   write.csv(kiir, '/nethome/amiklos/argyelan@gmail.com/projects/ECT/Bergen/ECTEF_collaboration/RULcorrelation/N156_dVOL_paired_sample_t_R_L.csv')
   long.kiir<-(reshape(kiir, idvar='roi', varying=list(6:7), v.names='dside',timevar='side',direction = 'long'))
   #ones<-which(long.kiir$side==1)
   #long.kiir$side<-1
   #long.kiir$side[ones]<-2

   fig.volchange<-ggplot(long.kiir, aes(x=factor(side),y=dside))+
     geom_boxplot(fill=c('orange','blue'))+
     geom_point(size=5)+
     geom_line(aes(group=roi), color='gray30')+
     scale_x_discrete(name='Hemispheres',labels=c('L','R'))+
     ylab('Volume change (d - effect size)')+
     theme(axis.text = element_text(size=22),axis.title = element_text(size = 28, face = "bold"))
  # +
  #   geom_text(aes(label=roi))
   #pdf('/nethome/amiklos/argyelan@gmail.com/projects/ECT/Bergen/ECTEF_collaboration/RULcorrelation/Regions_VolChange_Effect_Size.pdf', width=12,height=7)
   png('/nethome/amiklos/argyelan@gmail.com/projects/ECT/Bergen/ECTEF_collaboration/RULcorrelation/Regions_VolChange_Effect_Size.png',  width= 960, height = 960)
   fig.volchange
   dev.off()



#+END_SRC

#+RESULTS:
: 1

**** Calculating pairwise EF difference between R and L and Figure correlating between laterality indices
#+BEGIN_SRC R :session ECTanal
    myres6v3<-matrix(NA,floor(length(myroi.names)/2),6)
    ind.to.go.through<-c(1:5,7:10,20:52)
    library(stringr)
    m<-0
    for (i in ind.to.go.through)
    {
      m<-m+1
      if (length(grep('_Left',myroi.names[i]))==1)
      {
        rside<-str_replace(myroi.names[i],'_Left','_Right')
      } else if (length(grep('.lh.',myroi.names[i]))==1)
      {
        rside<-str_replace(myroi.names[i],'.lh.','.rh.')
      }
      j<-which(myroi.names==rside)
      dvol.r<-fd[ind.fd,grep(varnames[j,1],colnames(fd))]
      dvol.l<-fd[ind.fd,grep(varnames[i,1],colnames(fd))]
      res<-t.test(dvol.r,dvol.l,paired = TRUE)
      res.l<-t.test(dvol.l)
      res.r<-t.test(dvol.r)
  
      myres6v3[m,1]<-res$statistic
      myres6v3[m,2]<-res$p.value
      myres6v3[m,3]<-res$estimate
      myres6v3[m,4]<-res$estimate/sd(dvol.r-dvol.l,na.rm=TRUE)

  
    }
    kiir<-data.frame(myroi.names[ind.to.go.through],myres6v3,p.adjust(myres6v3[,2],method = 'fdr'))
    colnames(kiir)<-c('roi','t','p','mean','d','BH_FDR')
    write.csv(kiir, '/nethome/amiklos/argyelan@gmail.com/projects/ECT/Bergen/ECTEF_collaboration/RULcorrelation/N156_EF_paired_sample_t_R_L.csv')

    efvol<-data.frame(myroi.names[ind.to.go.through], myres5v3[,1:4],myres6v3[,1:4])
    colnames(efvol)<-c('roi','tvol','pvol','meanvol','dvol','tef','pef','meanef','def')
    fig.wo.label<-ggplot(efvol,aes(x=def,y=dvol))+
      stat_smooth(method='lm')+
      geom_point(size=5)+
      xlab('EF laterality index (d - effect size)')+
      ylab(Delta~'Volume laterality index (d - effect size)')+
      theme(axis.text = element_text(size=22),axis.title = element_text(size=22, face = "bold"))
    ,#+
     # geom_text(aes(label=roi))

    #pdf('/nethome/amiklos/argyelan@gmail.com/projects/ECT/Bergen/ECTEF_collaboration/RULcorrelation/Regions_EFvVOL.pdf', width=12,height=7)
    png('/nethome/amiklos/argyelan@gmail.com/projects/ECT/Bergen/ECTEF_collaboration/RULcorrelation/Regions_EFvVOL.png', width=1262,height=480)
    fig.wo.label
    dev.off()
   # fig.w.label

    summary(lm(dvol~def,data=efvol))
  result.cor.EFVOL_R_L<-cor.test(efvol$def,efvol$dvol)

#+END_SRC

#+RESULTS:

**** Calculating and writing out nii.gz images for showing 42 pairs of ROI representation of data
#+BEGIN_SRC R :session ECTanal
library(oro.nifti)
library(neurobase)
atlas<-readnii('/nethome/amiklos/ATLASES/OASIS-TRT-20_jointfusion_DKT31_CMA_labels_in_MNI152_v2.nii.gz')
atlas.2d<-matrix(atlas,1,byrow=T)

lut<-read.table('/usr/local/opt/freesurfer5.3/FreeSurferColorLUT.txt')

colnames(lut)<-c('ind','roi')
lat.im.2d<-matrix(0, 2,dim(atlas.2d)[2])
for (i in 1:dim(efvol)[1])#Left-Cerebellum-Exterior (instead of cortex)
{
  name<-str_replace(str_replace_all(efvol$roi[i], '\\.','-'),'EF_','')
  if (name=='Left-Cerebellum-Cortex' | name=='Right-Cerebellum-Cortex')
  {
    name<-str_replace(name,'Cortex','Exterior')
  }
  ind<-which(lut$roi==name)  
  num<-lut$ind[ind]
  indover<-which(atlas.2d[1,]==num)
  lat.im.2d[1,indover]<-efvol$def[i]
  lat.im.2d[2,indover]<-efvol$dvol[i]
  
}

lat.dEF=atlas
lat.dEF[]<-array(lat.im.2d[1,],dim(atlas))
writenii(nim = lat.dEF, '/nethome/amiklos/work/ECT/Bergen/N156_LATER_INDEX_dEF_regions.nii')

lat.dVOL=atlas
lat.dVOL[]<-array(lat.im.2d[2,],dim(atlas))
writenii(nim = lat.dVOL, '/nethome/amiklos/work/ECT/Bergen/N156_LATER_INDEX_dVOL_regions.nii')


#+END_SRC

**** Calculating simple correlation between meanEF and d \Delta Volume across regions
#+BEGIN_SRC R :session ECTanal
  myres8v3<-matrix(NA,length(myroi.names),4)
  #ind.to.go.through<-c(1:5,7:10,20:52)
  library(stringr)
  m<-0
  for (i in 1:length(myroi.names))
  {

    ef<-fd[ind.fd,grep(varnames[i,1],colnames(fd))]
    dvol<-fd[ind.fd,grep(varnames[i,2],colnames(fd))]
    r.ef<-t.test(ef)
    r.dvol<-t.test(dvol)
    myres8v3[i,1]<-r.ef$estimate
    myres8v3[i,2]<-r.dvol$estimate
    myres8v3[i,3]<-sd(ef,na.rm=T)
    myres8v3[i,4]<-sd(dvol,na.rm=T)



  }
  kiir<-data.frame(myroi.names,myres8v3)
  colnames(kiir)<-c('roi','mean_ef','mean_dvol','sd_ef','sd_dvol')
  kiir$side<-1
  kiir$side[ind.to.go.through]<-2
  plotEF_vs_change<-ggplot(kiir,aes(x=mean_ef,y=mean_dvol/sd_dvol))+
    #ggplot(kiir,aes(x=mean_ef,y=mean_dvol))+
    stat_smooth(method='lm')+
    geom_point(aes(colour=factor(side)),size=5)+
    scale_color_manual(labels=c('R','L'),values=c('blue','orange'))+
    labs(colour='SIDE')+
    xlab('Mean average EF')+
    ylab('Volume change (d - effect size)')+
    theme(axis.text = element_text(size=22), axis.title = element_text(size = 28, face = "bold"))  
  #facet_grid(.~side)
  ,#+
  #  geom_text(aes(label=roi))
  #pdf('/nethome/amiklos/argyelan@gmail.com/projects/ECT/Bergen/ECTEF_collaboration/RULcorrelation/Regions_ALL_meanEFvsdvol.pdf', width=12,height=7)
  png('/nethome/amiklos/argyelan@gmail.com/projects/ECT/Bergen/ECTEF_collaboration/RULcorrelation/Regions_ALL_meanEFvsdvol.png', width=960,height=960)
  plotEF_vs_change
  dev.off()
  cor.test(kiir$mean_dvol,kiir$mean_ef)
  result.cor.meanEFdvol<-cor.test(kiir$mean_dvol/kiir$sd_dvol,kiir$mean_ef)

#+END_SRC

#+RESULTS:

**** Calculating and writing out nii images across 85 ROIs
#+BEGIN_SRC R :session ECTanal
library(oro.nifti)
library(neurobase)
atlas<-readnii('/nethome/amiklos/ATLASES/OASIS-TRT-20_jointfusion_DKT31_CMA_labels_in_MNI152_v2.nii.gz')
atlas.2d<-matrix(atlas,1,byrow=T)

lut<-read.table('/usr/local/opt/freesurfer5.3/FreeSurferColorLUT.txt')

colnames(lut)<-c('ind','roi')
res.im.2d<-matrix(0, 3,dim(atlas.2d)[2])
m<-0
for (i in myroi.names)#Left-Cerebellum-Exterior (instead of cortex)
{
  m<-m+1
  name<-str_replace(str_replace_all(i, '\\.','-'),'EF_','')
  if (name=='Left-Cerebellum-Cortex' | name=='Right-Cerebellum-Cortex')
  {
    name<-str_replace(name,'Cortex','Exterior')
  }
  ind<-which(lut$roi==name)  
  num<-lut$ind[ind]
  indover<-which(atlas.2d[1,]==num)
  res.im.2d[1,indover]<-kiir$mean_ef[m]
  res.im.2d[2,indover]<-kiir$mean_dvol[m]/kiir$sd_dvol[m]
  res.im.2d[3,indover]<-kiir$mean_dvol[m]
  
}

meanEF=atlas
meanEF[]<-array(res.im.2d[1,],dim(atlas))
writenii(nim = meanEF, '/nethome/amiklos/work/ECT/Bergen/N156_meanEF_regions.nii')

dVOL=atlas
dVOL[]<-array(res.im.2d[2,],dim(atlas))
writenii(nim = dVOL, '/nethome/amiklos/work/ECT/Bergen/N156_effectsize_volumechange_regions.nii')

meanVOL=atlas
meanVOL[]<-array(res.im.2d[3,],dim(atlas))
writenii(nim = meanEF, '/nethome/amiklos/work/ECT/Bergen/N156_meanVOLch_regions.nii')


#+END_SRC

*** Create Figures

**** Figures with ROIs

***** Volume and EF comparision figure, plus adding correlations and boxplot BIG
 #+BEGIN_SRC sh
 cd /nethome/amiklos/work/ECT/Bergen
 overlay 1 0 /usr/local/fsl/data/standard/MNI152_T1_1mm_brain.nii.gz -A N156_effectsize_volumechange_regions.nii.gz 0.01 1.7678  test.nii.gz
 #slicer N156_effectsize_volumechange_regions.nii.gz -l /usr/share/fsl/5.0/etc/luts/rendersea.lut -i -1.7678 1.7678   -x 0.3 sla.png -x 0.35 slb.png -x 0.5 kozep.png -x 0.60 slc.png -x 0.65 sld.png -y 0.35 sle.png -y 0.45 slf.png -y 0.55 slg.png -y 0.65 slh.png -z 0.32 sli.png -z 0.4 slj.png -z 0.55 slk.png -z 0.65 sll.png 
 slicer test.nii.gz -l /usr/share/fsl/5.0/etc/luts/renderhot.lut  -x 0.3 sla.png -x 0.35 slb.png -x 0.5 kozep.png -x 0.60 slc.png -x 0.65 sld.png -y 0.35 sle.png -y 0.45 slf.png -y 0.55 slg.png -y 0.65 slh.png -z 0.32 sli.png -z 0.4 slj.png -z 0.55 slk.png -z 0.65 sll.png 
 pngappend sla.png + slb.png + kozep.png + slc.png + sld.png + sle.png + slf.png + slg.png + slh.png + sli.png + slj.png + slk.png + sll.png + hot_scale.png N156_effectsize_volume2standard.png

 overlay 1 0 /usr/local/fsl/data/standard/MNI152_T1_1mm_brain.nii.gz -A  N156_meanEF_regions.nii.gz 1 189.62  EFoverlay.nii.gz
 #slicer N156_meanEF_regions.nii.gz -l /usr/share/fsl/5.0/etc/luts/rendersea.lut -i -189.62 189.62   -x 0.3 sla.png -x 0.35 slb.png -x 0.5 kozep.png -x 0.60 slc.png -x 0.65 sld.png -y 0.35 sle.png -y 0.45 slf.png -y 0.55 slg.png -y 0.65 slh.png -z 0.32 sli.png -z 0.4 slj.png -z 0.55 slk.png -z 0.65 sll.png 
 slicer EFoverlay.nii.gz -l /usr/share/fsl/5.0/etc/luts/renderhot.lut   -x 0.3 sla.png -x 0.35 slb.png -x 0.5 kozep.png -x 0.60 slc.png -x 0.65 sld.png -y 0.35 sle.png -y 0.45 slf.png -y 0.55 slg.png -y 0.65 slh.png -z 0.32 sli.png -z 0.4 slj.png -z 0.55 slk.png -z 0.65 sll.png 
 pngappend sla.png + slb.png + kozep.png + slc.png + sld.png + sle.png + slf.png + slg.png + slh.png + sli.png + slj.png + slk.png + sll.png + hot_scale.png N156_meanEF_volume2standard.png
 pngappend N156_meanEF_volume2standard.png - N156_effectsize_volume2standard.png N156_meanEF_vs_dVolume.png
 convert N156_meanEF_vs_dVolume.png -fill white -opaque black WHITE-N156_meanEF_vs_dVolume.png  
 convert -font helvetica -fill black -pointsize 16 -gravity center -draw "text -1200,10 'x = 35 ' text -990,10 'x = 26 ' text -770,10 'x = -1 ' text -550,10 'x = -19' text -330,10 'x = -28' text -125,10 'y = -50' text 60,10 'y = -28' text 245,10 'y = -6' text 420,10 'y = 16' text 605,10 'z = -14' text 785,10 'z = 1' text 970,10 'z = 28' text 1150,10 'z = 46' text 1246,-30 '0' text 1246,-170 '190' text 1246,185 '0.0' text 1246,40 '1.8'" WHITE-N156_meanEF_vs_dVolume.png  TXT-WHITE-N156_meanEF_vs_dVolume.png    
 
 # montage -geometry 1103x1203+100+0 /nethome/amiklos/argyelan@gmail.com/projects/ECT/Bergen/ECTEF_collaboration/RULcorrelation/Regions_VolChange_Effect_Size.pdf /nethome/amiklos/argyelan@gmail.com/projects/ECT/Bergen/ECTEF_collaboration/RULcorrelation/Regions_ALL_meanEFvsdvol.pdf /nethome/amiklos/argyelan@gmail.com/projects/ECT/Bergen/ECTEF_collaboration/RULcorrelation/Regions_Vol.png
 montage -geometry 1103x1203+100+0 /nethome/amiklos/argyelan@gmail.com/projects/ECT/Bergen/ECTEF_collaboration/RULcorrelation/Regions_VolChange_Effect_Size.png /nethome/amiklos/argyelan@gmail.com/projects/ECT/Bergen/ECTEF_collaboration/RULcorrelation/Regions_ALL_meanEFvsdvol.png /nethome/amiklos/argyelan@gmail.com/projects/ECT/Bergen/ECTEF_collaboration/RULcorrelation/Regions_Vol.png
 # pngappend /nethome/amiklos/argyelan@gmail.com/projects/ECT/Bergen/ECTEF_collaboration/RULcorrelation/Regions_VolChange_Effect_Size.png + /nethome/amiklos/argyelan@gmail.com/projects/ECT/Bergen/ECTEF_collaboration/RULcorrelation/Regions_ALL_meanEFvsdvol.png /nethome/amiklos/argyelan@gmail.com/projects/ECT/Bergen/ECTEF_collaboration/RULcorrelation/Regions_Vol.png
 pngappend TXT-WHITE-N156_meanEF_vs_dVolume.png - /nethome/amiklos/argyelan@gmail.com/projects/ECT/Bergen/ECTEF_collaboration/RULcorrelation/Regions_Vol.png Figure_ROI_based_volume_change.png
  #+END_SRC

  #+RESULTS:

***** Volume and EF comparision figure, plus adding correlations and boxplot SMALL
 #+BEGIN_SRC sh
 cd /nethome/amiklos/work/ECT/Bergen
 overlay 1 0 /usr/local/fsl/data/standard/MNI152_T1_1mm_brain.nii.gz -A N156_effectsize_volumechange_regions.nii.gz 0.01 1.7678  test.nii.gz
 #slicer N156_effectsize_volumechange_regions.nii.gz -l /usr/share/fsl/5.0/etc/luts/rendersea.lut -i -1.7678 1.7678   -x 0.3 sla.png -x 0.35 slb.png -x 0.5 kozep.png -x 0.60 slc.png -x 0.65 sld.png -y 0.35 sle.png -y 0.45 slf.png -y 0.55 slg.png -y 0.65 slh.png -z 0.32 sli.png -z 0.4 slj.png -z 0.55 slk.png -z 0.65 sll.png 
 slicer test.nii.gz -l /usr/share/fsl/5.0/etc/luts/renderhot.lut  -x 0.3 sla.png -x 0.35 slb.png -x 0.5 kozep.png -x 0.60 slc.png -x 0.65 sld.png -y 0.35 sle.png -y 0.45 slf.png -y 0.55 slg.png -y 0.65 slh.png -z 0.32 sli.png -z 0.4 slj.png -z 0.55 slk.png -z 0.65 sll.png 
 pngappend slb.png + kozep.png + slc.png + slf.png + slg.png + slh.png + sli.png + slj.png + slk.png + hot_scale.png N156_effectsize_volume2standard.png

 overlay 1 0 /usr/local/fsl/data/standard/MNI152_T1_1mm_brain.nii.gz -A  N156_meanEF_regions.nii.gz 1 189.62  EFoverlay.nii.gz
 #slicer N156_meanEF_regions.nii.gz -l /usr/share/fsl/5.0/etc/luts/rendersea.lut -i -189.62 189.62   -x 0.3 sla.png -x 0.35 slb.png -x 0.5 kozep.png -x 0.60 slc.png -x 0.65 sld.png -y 0.35 sle.png -y 0.45 slf.png -y 0.55 slg.png -y 0.65 slh.png -z 0.32 sli.png -z 0.4 slj.png -z 0.55 slk.png -z 0.65 sll.png 
 slicer EFoverlay.nii.gz -l /usr/share/fsl/5.0/etc/luts/renderhot.lut   -x 0.3 sla.png -x 0.35 slb.png -x 0.5 kozep.png -x 0.60 slc.png -x 0.65 sld.png -y 0.35 sle.png -y 0.45 slf.png -y 0.55 slg.png -y 0.65 slh.png -z 0.32 sli.png -z 0.4 slj.png -z 0.55 slk.png -z 0.65 sll.png 
 pngappend slb.png + kozep.png + slc.png  + slf.png + slg.png + slh.png + sli.png + slj.png + slk.png + hot_scale.png N156_meanEF_volume2standard.png
 pngappend N156_meanEF_volume2standard.png - N156_effectsize_volume2standard.png N156_meanEF_vs_dVolume.png
 convert N156_meanEF_vs_dVolume.png -fill white -opaque black WHITE-N156_meanEF_vs_dVolume.png  
 convert -font helvetica -fill black -pointsize 16 -gravity center -draw "text
 -790,10 'x = 26 ' text -565,10 'x = -1 ' text -360,10 'x = -19' text -155,10
 'y = -28' text 30,10 'y = -6' text 215,10 'y = 16' text 385,10 'z = -14' text
 572,10 'z = 1' text 755,10 'z = 28'  text 850,-30 '0' text 850,-170 '190' text
 850,185 '0.0' text 850,40 '1.8' text 870,-200 '(V/m)' text 870,10 'd' text
 -840,-190 'Electrical Field' text -840,35 'Volume change'" WHITE-N156_meanEF_vs_dVolume.png  small-TXT-WHITE-N156_meanEF_vs_dVolume.png    
 
 # montage -geometry 1103x1203+100+0 /nethome/amiklos/argyelan@gmail.com/projects/ECT/Bergen/ECTEF_collaboration/RULcorrelation/Regions_VolChange_Effect_Size.pdf /nethome/amiklos/argyelan@gmail.com/projects/ECT/Bergen/ECTEF_collaboration/RULcorrelation/Regions_ALL_meanEFvsdvol.pdf /nethome/amiklos/argyelan@gmail.com/projects/ECT/Bergen/ECTEF_collaboration/RULcorrelation/Regions_Vol.png
 montage -geometry 703x903+100+0 /nethome/amiklos/argyelan@gmail.com/projects/ECT/Bergen/ECTEF_collaboration/RULcorrelation/Regions_VolChange_Effect_Size.png /nethome/amiklos/argyelan@gmail.com/projects/ECT/Bergen/ECTEF_collaboration/RULcorrelation/Regions_ALL_meanEFvsdvol.png /nethome/amiklos/argyelan@gmail.com/projects/ECT/Bergen/ECTEF_collaboration/RULcorrelation/Regions_Vol.png
 # pngappend /nethome/amiklos/argyelan@gmail.com/projects/ECT/Bergen/ECTEF_collaboration/RULcorrelation/Regions_VolChange_Effect_Size.png + /nethome/amiklos/argyelan@gmail.com/projects/ECT/Bergen/ECTEF_collaboration/RULcorrelation/Regions_ALL_meanEFvsdvol.png /nethome/amiklos/argyelan@gmail.com/projects/ECT/Bergen/ECTEF_collaboration/RULcorrelation/Regions_Vol.png
 pngappend small-TXT-WHITE-N156_meanEF_vs_dVolume.png - /nethome/amiklos/argyelan@gmail.com/projects/ECT/Bergen/ECTEF_collaboration/RULcorrelation/Regions_Vol.png Figure_small_ROI_based_volume_change.png
  #+END_SRC

  #+RESULTS:

***** Laterality Index Figures
 #+BEGIN_SRC sh
  cd /nethome/amiklos/work/ECT/Bergen
 #overlay 1 0 /usr/local/fsl/data/standard/MNI152_T1_1mm_brain.nii.gz -A   N156_LATER_INDEX_dEF_regions.nii.gz 0.01 5.5621  dEF_LAT_INDEX_overlay.nii.gz
 fslroi  N156_LATER_INDEX_dEF_regions.nii.gz half_lat_EF.nii.gz 91 91 0 218 0 182 0 1
 overlay 1 0 half_brain.nii.gz -A   half_lat_EF.nii.gz 1 5.5621  dEF_LAT_INDEX_overlay.nii.gz
 #slicer N156_LATER_INDEX_dEF_regions.nii.gz -l /usr/share/fsl/5.0/etc/luts/rendersea.lut -i -5.5621 5.5621   -x 0.3 sla.png -x 0.35 slb.png -x 0.5 kozep.png -x 0.60 slc.png -x 0.65 sld.png -y 0.35 sle.png -y 0.45 slf.png -y 0.55 slg.png -y 0.65 slh.png -z 0.32 sli.png -z 0.4 slj.png -z 0.55 slk.png -z 0.65 sll.png 
 slicer dEF_LAT_INDEX_overlay.nii.gz -l /usr/share/fsl/5.0/etc/luts/renderhot.lut  -x 0.3 sla.png -x 0.35 slb.png -x 0.05 kozep.png -x 0.5 slc.png -x 0.65 sld.png -y 0.35 sle.png -y 0.45 slf.png -y 0.55 slg.png -y 0.65 slh.png -z 0.32 sli.png -z 0.4 slj.png -z 0.55 slk.png -z 0.65 sll.png 
 convert kozep.png -crop 198x218+7+0 crop_kozep.png
 convert slc.png -crop 148x218+35+0 crop_slc.png
 convert sld.png -crop 128x218+45+0 crop_sld.png
 pngappend crop_kozep.png + crop_slc.png + crop_sld.png + sle.png + slf.png + slg.png + slh.png + sli.png + slj.png + slk.png + sll.png + hot_scale.png  N156_LATERINDEX_dEF_volume2standard.png

 #overlay 1 0 /usr/local/fsl/data/standard/MNI152_T1_1mm_brain.nii.gz -A   N156_LATER_INDEX_dVOL_regions.nii.gz 0.001 0.8  dVOL_LAT_INDEX_overlay.nii.gz
 fslroi  N156_LATER_INDEX_dVOL_regions.nii.gz half_lat_dVOL.nii.gz 91 91 0 218 0 182 0 1
 fslmaths half_lat_dVOL.nii.gz -abs abs_half_lat_dVOL #in this way very low negative values are mapped into the low values it is easier to visualize
 overlay 1 0 half_brain.nii.gz -A   abs_half_lat_dVOL.nii.gz 0.001 0.8  dVOL_LAT_INDEX_overlay.nii.gz
 #slicer N156_LATER_INDEX_dVOL_regions.nii.gz -l /usr/share/fsl/5.0/etc/luts/rendersea.lut -i -0.8 0.8  -x 0.3 sla.png -x 0.35 slb.png -x 0.5 kozep.png -x 0.60 slc.png -x 0.65 sld.png -y 0.35 sle.png -y 0.45 slf.png -y 0.55 slg.png -y 0.65 slh.png -z 0.32 sli.png -z 0.4 slj.png -z 0.55 slk.png -z 0.65 sll.png 
 slicer dVOL_LAT_INDEX_overlay.nii.gz -l /usr/share/fsl/5.0/etc/luts/renderhot.lut  -x 0.3 sla.png -x 0.35 slb.png -x 0.05 kozep.png -x 0.5 slc.png -x 0.65 sld.png -y 0.35 sle.png -y 0.45 slf.png -y 0.55 slg.png -y 0.65 slh.png -z 0.32 sli.png -z 0.4 slj.png -z 0.55 slk.png -z 0.65 sll.png 
 convert kozep.png -crop 198x218+7+0 crop_kozep.png
 convert slc.png -crop 148x218+35+0 crop_slc.png
 convert sld.png -crop 128x218+45+0 crop_sld.png
 pngappend crop_kozep.png + crop_slc.png + crop_sld.png + sle.png + slf.png + slg.png + slh.png + sli.png + slj.png + slk.png + sll.png + hot_scale.png N156_LATERINDEX_dVOL_volume2standard.png

 pngappend N156_LATERINDEX_dEF_volume2standard.png - N156_LATERINDEX_dVOL_volume2standard.png N156_LATERINDEX_dEF_versus_dVOL.png
 convert N156_LATERINDEX_dEF_versus_dVOL.png -fill white -opaque black WHITE-N156_LATERINDEX_dEF_versus_dVOL.png
 convert -font helvetica -fill black -pointsize 16 -gravity center -draw "text -540,10 'x = -6 ' text -360,10 'x = -47' text -230,10 'x = -60' text -125,10 'y = -50' text -30,10 'y = -28' text 60,10 'y = -6' text 145,10 'y = 16' text 230,10 'z = -14' text 325,10 'z = 1' text 420,10 'z = 28' text 510,10 'z = 46' text 575,-30 '1.0' text 575,-170 '5.6' text 575,185 '0.0' text 575,40 '0.8' text 602,-190 'd' text 602,20 'd'" WHITE-N156_LATERINDEX_dEF_versus_dVOL.png TXT-WHITE-N156_LATERINDEX_dEF_versus_dVOL.png
 pngappend TXT-WHITE-N156_LATERINDEX_dEF_versus_dVOL.png - /nethome/amiklos/argyelan@gmail.com/projects/ECT/Bergen/ECTEF_collaboration/RULcorrelation/Regions_EFvVOL.png Figure_LatInd_42ROI.png
 #+END_SRC

 #+RESULTS:

**** Figures for individual variability

***** Calculating the individual relationships in Hippocampus
#+BEGIN_SRC R :session ECTanal
    # missing hippocampus data in 4 patients imputed here with mean, missing from
    # table provided by Leif

    pat<-1:151
    ind.m<-which(is.na(fd$volumechange_Left.Hippocampus[pat]))
    fd$volumechange_im_Left.Hippocampus<-fd$volumechange_Left.Hippocampus
    fd$volumechange_im_Left.Hippocampus[pat][ind.m]<-mean(fd$volumechange_Left.Hippocampus[pat],na.rm = T)
    fd$volumechange_im_Right.Hippocampus<-fd$volumechange_Right.Hippocampus
    fd$volumechange_im_Right.Hippocampus[pat][ind.m]<-mean(fd$volumechange_Right.Hippocampus[pat],na.rm = T)

    plotdata<-data.frame(fd$EF_Left.Hippocampus,fd$EF_Right.Hippocampus,fd$volumechange_im_Left.Hippocampus, fd$volumechange_im_Right.Hippocampus,fd$SubjID)
    plotdata.long<-reshape(plotdata,direction = "long", idvar = "fd.SubjID", varying=list(c(1,2),c(3,4)))
    plotA<-ggplot(plotdata.long,aes(x=fd.EF_Left.Hippocampus,y=fd.volumechange_im_Left.Hippocampus, colour=factor(time)))+
      stat_smooth(method='lm')+
      geom_point()+
      labs(colour='Side')+
      xlab('Electrical Field (V/m)')+
      ylab('Volume change (%)')+
      scale_color_manual(labels=c('L','R'),values = c('orange','blue'))

    plotA

    plotB<-ggplot(plotdata.long,aes(x=factor(time),y=fd.volumechange_im_Left.Hippocampus))+
      geom_boxplot(fill=c('orange','blue'))+
      geom_point()+
      geom_line(aes(group = fd.SubjID), colour='gray')+
      scale_x_discrete(name='Hemispheres',labels=c('L','R'))+
      ylab('Volume change (%)')

    plotB

  require(gridExtra)  
  #pdf('/nethome/amiklos/argyelan@gmail.com/projects/ECT/Bergen/ECTEF_collaboration/RULcorrelation/v2-EF_v_Hippocampus.pdf', width=12,height=7)
  png('/nethome/amiklos/argyelan@gmail.com/projects/ECT/Bergen/ECTEF_collaboration/RULcorrelation/v2-EF_v_Hippocampus.png', width=820,height=480)
  grid.arrange(plotA,plotB,ncol=2, widths=c(3,1))
  dev.off()

  result.cor.hippocampus<-list()
  result.cor.hippocampus[[1]]<-cor.test(plotdata.long$fd.EF_Left.Hippocampus,plotdata.long$fd.volumechange_im_Left.Hippocampus)
  result.cor.hippocampus[[2]]<-cor.test(fd$EF_Left.Hippocampus, fd$volumechange_im_Left.Hippocampus)
  result.cor.hippocampus[[3]]<-cor.test(fd$EF_Right.Hippocampus, fd$volumechange_im_Right.Hippocampus)
  result.cor.hippocampus[[4]]<-t.test(fd$volumechange_im_Right.Hippocampus, fd$volumechange_im_Left.Hippocampus, paired = T)
#+END_SRC

#+RESULTS:

***** Calculating the individual relationships in Amygdala
 #+BEGIN_SRC R :session ECTanal
      plotdata<-data.frame(fd$EF_Left.Amygdala,fd$EF_Right.Amygdala,fd$volumechange_Left.Amygdala, fd$volumechange_Right.Amygdala,fd$SubjID)
      plotdata.long<-reshape(plotdata,direction = "long", idvar = "fd.SubjID", varying=list(c(1,2),c(3,4)))
      plotA<-ggplot(plotdata.long,aes(x=fd.EF_Left.Amygdala,y=fd.volumechange_Left.Amygdala, colour=factor(time)))+
        stat_smooth(method='lm')+
        geom_point()+
        labs(colour='Side')+
        xlab('Electrical Field (V/m)')+
        ylab('Volume change (%)')+
        scale_color_manual(labels=c('L','R'),values = c('orange','blue'))

      plotA

      plotB<-ggplot(plotdata.long,aes(x=factor(time),y=fd.volumechange_Left.Amygdala))+
        geom_boxplot(fill=c('orange','blue'))+
        geom_point()+
        geom_line(aes(group = fd.SubjID), colour='gray')+
        scale_x_discrete(name='Hemispheres',labels=c('L','R'))+
        ylab('Volume change (%)')

      plotB

    require(gridExtra)  
    #pdf('/nethome/amiklos/argyelan@gmail.com/projects/ECT/Bergen/ECTEF_collaboration/RULcorrelation/v2-EF_v_Amygdala.pdf', width=12,height=7)
    png('/nethome/amiklos/argyelan@gmail.com/projects/ECT/Bergen/ECTEF_collaboration/RULcorrelation/v2-EF_v_Amygdala.png', width=820,height=480)
    grid.arrange(plotA,plotB,ncol=2, widths=c(3,1))
    dev.off()
   result.cor.amygdala<-list()
   result.cor.amygdala[[1]]<-cor.test(plotdata.long$fd.EF_Left.Amygdala,plotdata.long$fd.volumechange_Left.Amygdala)
   result.cor.amygdala[[2]]<-cor.test(fd$EF_Left.Amygdala, fd$volumechange_Left.Amygdala)
   result.cor.amygdala[[3]]<-cor.test(fd$EF_Right.Amygdala, fd$volumechange_Right.Amygdala)
   result.cor.amygdala[[4]]<-t.test(fd$volumechange_Right.Amygdala, fd$volumechange_Left.Amygdala, paired = T)
 #+END_SRC

 #+RESULTS:

***** Calculating the individual specificity of the EF across different EF patterns
 #+BEGIN_SRC R :session ECTanal

     myres.p<-matrix(NA,length(myroi.names),length(myroi.names))
     for (j in 1:dim(varnames)[1])
     {
       #perm.varnames<-permute(varnames[,1])
       for (i in 1:dim(varnames)[1])
       {
         ef<-fd[ind.fd,grep(varnames[j,1],colnames(fd))]
         dvol<-fd[ind.fd,grep(varnames[i,2],colnames(fd))]
         lm.1<-lm(dvol~ef+Age.1+rul_number.1+Site.1,data=fd[ind.fd,])
         #lm.1<-lm(dvol~ef,data=fd[ind.fd,])
         res<-summary(lm.1)
         myres.p[i,j]<-res$coefficients[2,3]
         #myres.p[i,2]<-res$coefficients[2,4]
       }
       print(j)
     }
     perm.res<-data.frame(myroi.names,t(myres.p)) #EF fix and dVOL is changing
     #perm.res<-data.frame(myroi.names,myres.p) #dVOL is fixed and EF is changing

     #colnames(fdr.res)<-c('myroi.names','t','p','q')
     RES<-merge(fdr.res,perm.res,by.x='roi',by.y='myroi.names')
     long.RES<-reshape(RES,direction = 'long',idvar = 'roi', varying = list(10:dim(RES)[2]),v.names = 'perm.t',timevar = 'permnum')

     library(ggplot2)
     ind<-which(long.RES$'BH^EF_FDR'<0.01)
     #blues<-data.frame(long.RES[ind,]$roi[which(long.RES$permnum[ind]%in%mtl)],long.RES[ind,]$perm.t[which(long.RES$permnum[ind]%in%mtl)])
     #colnames(blues)<-c('roi','value')
     #long.RES2<-merge(long.RES,blues,by='roi')
     fig.spec<-ggplot(data=long.RES[ind,],aes(x=roi,y=perm.t))+
       geom_boxplot(outlier.shape = NA)+
       geom_jitter(width = 0.1)+
       geom_point(aes(y=t_EF),col = 'red', size = 5)+
       theme(axis.text.x=element_text(angle=45,hjust=1))+
       scale_x_discrete(labels=c('','',''))+
         xlab('')+
         ylab(expression(EF~'~'~Delta*Vol[permutating]~(t[EF])))

   perm.res<-data.frame(myroi.names,myres.p) #dVOL is fixed and EF is changing
     RES<-merge(fdr.res,perm.res,by.x='roi',by.y='myroi.names')
     long.RES<-reshape(RES,direction = 'long',idvar = 'roi', varying = list(10:dim(RES)[2]),v.names = 'perm.t',timevar = 'permnum')
     ind<-which(long.RES$'BH^EF_FDR'<0.01)

     fig.spec.2<-ggplot(data=long.RES[ind,],aes(x=roi,y=perm.t))+
       geom_boxplot(outlier.shape = NA)+
       geom_jitter(width = 0.1)+
       geom_point(aes(y=t_EF),col = 'red', size = 5)+
         theme(axis.text.x=element_text(angle=45,hjust=1))+
         scale_x_discrete(labels=c(expression(Amygdala[LEFT]),expression(Hippocampus[LEFT]),expression(Amygdala[RIGHT])))+
         xlab('')+
             ylab(expression(EF[permutating]~'~'~Delta*Vol~(t[EF])))
   fig.spec.2
#+END_SRC

#+RESULTS:

#+BEGIN_SRC R :session ECTanal 


  require(gridExtra)  
    #pdf('/nethome/amiklos/argyelan@gmail.com/projects/ECT/Bergen/ECTEF_collaboration/RULcorrelation/EF-Volume-Specificity.pdf', width=8,height=12)
    png('/nethome/amiklos/argyelan@gmail.com/projects/ECT/Bergen/ECTEF_collaboration/RULcorrelation/EF-Volume-Specificity.png', width=480,height=720)
    grid.arrange(fig.spec,fig.spec.2,nrow=2,heights=c(4,5))
    dev.off()


 #+END_SRC

 #+RESULTS:
 : 1

* Demographic Data and Statistics 

** Sample Size
#+BEGIN_SRC R :session ECTanal :exports none :results values drawer
mean.age<-mean(fd$Age.1[ind.fd])
sd.age<-sd(fd$Age.1[ind.fd])
N <-length(which(!is.na(fd$volumechange_Right.Amygdala)))
fem<-length(which(fd$Sex.1[ind.fd]=='F'))
Nres = paste0('#+MACRO: N ',N)
meanres = paste0('#+MACRO: ma ',round(mean.age,1))
sdres = paste0('#+MACRO: sa ',round(sd.age,1))
femres = paste0('#+MACRO: fem ',fem)
paste0(Nres,'\n',  meanres, '\n', sdres, '\n', femres)
#mean.age
#+END_SRC
#+RESULTS:
:RESULTS:
#+MACRO: N 151
#+MACRO: ma 57.3
#+MACRO: sa 17.1
#+MACRO: fem 94
:END:
We analyzed N = {{{N}}}({{{fem}}}F); Age: {{{ma}}} +/- {{{sa}}}.

** Clinical Outcome

*** Basic relationships
#+BEGIN_SRC R :session ECTanal :exports none :results values drawer
  madrschange<-mean(fd$madrs_hdrs_percentage_cahnge[ind.fd])
  sdmadrschange<-sd(fd$madrs_hdrs_percentage_cahnge[ind.fd])
  madrsbaseline<-mean(fd$madrs_hdrs_conversion.1[ind.fd])
  rangemadrsbaseline<-range(fd$madrs_hdrs_conversion.1[ind.fd])
  madrs3<-mean(fd$madrs_hdrs_conversion.3[ind.fd])
  rangemadrs3<-range(fd$madrs_hdrs_conversion.3[ind.fd])
  line1 = paste0('#+MACRO: MADRSbas ',round(madrsbaseline,1))
  line2 = paste0('#+MACRO: rb1 ',rangemadrsbaseline[1])
  line3 = paste0('#+MACRO: rb2 ',rangemadrsbaseline[2])
  line4 = paste0('#+MACRO: MADRS3 ',round(madrs3,1))
  line5 = paste0('#+MACRO: r31 ',rangemadrs3[1])
  line6 = paste0('#+MACRO: r32 ',rangemadrs3[2])
  line7 = paste0('#+MACRO: mch ',round(madrschange*100,1))
  line8 = paste0('#+MACRO: sdmch ',round(sdmadrschange*100,1))

  paste0(line1,'\n', line2,'\n', line3,'\n', line4,'\n', line5,'\n', line6,'\n', line7,'\n', line8)
  #mean.age
#+END_SRC
#+RESULTS:
:RESULTS:
#+MACRO: MADRSbas 33.9
#+MACRO: rb1 14
#+MACRO: rb2 54
#+MACRO: MADRS3 12.9
#+MACRO: r31 0
#+MACRO: r32 51
#+MACRO: mch 60.9
#+MACRO: sdmch 33.9
:END:
The mean of baseline MADRS was {{{MADRSbas}}} (range: {{{rb1}}}-{{{rb2}}}). At
the end of the course of ECT MADRS was {{{MADRS3}}} (range:
{{{r31}}}-{{{r32}}}). The average improvement was {{{mch}}} +/- {{{sdmch}}}%.

*** Confounds

**** Age and clinical response
#+BEGIN_SRC R :session ECTanal :exports none :results values drawer
    res<-cor.test(fd$madrs_hdrs_percentage_cahnge[1:151],fd$Age.1[1:151])
    line1 = paste0('#+MACRO: c1 ',round(res$statistic,2))
    line2 = paste0('#+MACRO: c2 ',res$parameter)
    line3 = paste0('#+MACRO: c3 ',round(res$estimate,2))
    line4 = paste0('#+MACRO: c4 ',round(res$p.value,3))
  paste0(line1, '\n', line2, '\n', line3 , '\n', line4)



#+END_SRC

#+RESULTS:
:RESULTS:
#+MACRO: c1 5.75
#+MACRO: c2 149
#+MACRO: c3 0.43
#+MACRO: c4 0
:END:



Age was correlating with clincal response (t = {{{c1}}}, df = {{{c2}}}, r =
{{{c3}}}, p = {{{c4}}}.


**** Age and Total Brain Volume
#+BEGIN_SRC R :session ECTanal :exports none :results values drawer
    res<-cor.test(fd$WholeBrain.baseline.3,fd$Age.1)
    line1 = paste0('#+MACRO: tot1 ',round(res$statistic,2))
    line2 = paste0('#+MACRO: tot2 ',res$parameter)
    line3 = paste0('#+MACRO: tot3 ',round(res$estimate,2))
    line4 = paste0('#+MACRO: tot4 ',round(res$p.value,3))
  paste0(line1, '\n', line2, '\n', line3 , '\n', line4)



#+END_SRC

#+RESULTS:
:RESULTS:
#+MACRO: tot1 -7.32
#+MACRO: tot2 149
#+MACRO: tot3 -0.51
#+MACRO: tot4 0
:END:



Age was correlating with total brain volume (t = {{{tot1}}}, df = {{{tot2}}}, r =
{{{tot3}}}, p = {{{tot4}}}.

** Correlation statistics

*** Correlation between EF and Volume across regions
#+BEGIN_SRC R :session ECTanal :exports none :results values drawer
  res<-result.cor.meanEFdvol
  line1 = paste0('#+MACRO: r ',round(res$estimate,2) )
  line2 = paste0('#+MACRO: p ',round(res$p.value,4) )
  line3 = paste0('#+MACRO: df ',res$parameter )
  line4 = paste0('#+MACRO: t ',round(res$statistic,2) ) 
paste0(line1,'\n', line2,'\n', line3,'\n', line4)
#+END_SRC

#+RESULTS:
:RESULTS:
#+MACRO: r 0.38
#+MACRO: p 3e-04
#+MACRO: df 83
#+MACRO: t 3.77
:END:

The correlation between mean EF and effect size of volume change: r = {{{r}}};
p = {{{p}}}; df = {{{df}}}; t = {{{t}}}.

*** Correlation between EF and Volume across laterality indices
#+BEGIN_SRC R :session ECTanal :exports none :results values drawer
  res<-result.cor.EFVOL_R_L
  line1 = paste0('#+MACRO: r_1 ',round(res$estimate,2) )
  line2 = paste0('#+MACRO: p_1 ',round(res$p.value,4) )
  line3 = paste0('#+MACRO: df_1 ',res$parameter )
  line4 = paste0('#+MACRO: t_1 ',round(res$statistic,2) ) 
paste0(line1,'\n', line2,'\n', line3,'\n', line4)
#+END_SRC

#+RESULTS:
:RESULTS:
#+MACRO: r_1 0.32
#+MACRO: p_1 0.0397
#+MACRO: df_1 40
#+MACRO: t_1 2.13
:END:

The correlation between EF and volume change laterality indices: r = {{{r_1}}};
p = {{{p_1}}}; df = {{{df_1}}}; t = {{{t_1}}}.

*** Correlation between EF and Volume in Hippocampus
#+BEGIN_SRC R :session ECTanal :results output raw :exports results

    library(ascii)
    library(stringr)
  res<-result.cor.hippocampus
  tres<-matrix(NA, 4,4)
  for (i in 1:4)
  {
      tres[i,1]<-res[[i]]$statistic
      tres[i,2]<-res[[i]]$parameter
      tres[i,3]<-res[[i]]$p.value
      tres[i,4]<-res[[i]]$estimate
  }
  tres<-data.frame(tres)
  colnames(tres)<-c('t','df','p','estimate (r or mean difference)')
  rownames(tres)<-c('all','left', 'right', 'paired-t-test')
  tres.asc<-ascii(tres, colnames=colnames(tres),digits=4,
               caption="The relationship between EF and volume change in the hippocampus")
  print(tres.asc,type="org")
#+END_SRC

#+RESULTS:
#+NAME: table-hippocampus
#+CAPTION: The relationship between EF and volume change in the hippocampus
|               | t      | df       | p      | estimate (r or mean difference) |
|---------------+--------+----------+--------+---------------------------------|
| all           | 5.9700 | 300.0000 | 0.0000 | 0.3259                          |
| left          | 4.5322 | 149.0000 | 0.0000 | 0.3481                          |
| right         | 1.5857 | 149.0000 | 0.1149 | 0.1288                          |
| paired-t-test | 7.7557 | 150.0000 | 0.0000 | 0.0112                          |

*** Correlation between EF and Volume in Amygdala
#+BEGIN_SRC R :session ECTanal :results output raw :exports results

    library(ascii)
    library(stringr)
  res<-result.cor.amygdala
  tres<-matrix(NA, 4,4)
  for (i in 1:4)
  {
      tres[i,1]<-res[[i]]$statistic
      tres[i,2]<-res[[i]]$parameter
      tres[i,3]<-res[[i]]$p.value
      tres[i,4]<-res[[i]]$estimate
  }
  tres<-data.frame(tres)
  colnames(tres)<-c('t','df','p','estimate (r or mean difference)')
  rownames(tres)<-c('all','left', 'right', 'paired-t-test')
  tres.asc<-ascii(tres, colnames=colnames(tres),digits=4,
               caption="The relationship between EF and volume change in the amygdala")
  print(tres.asc,type="org")
#+END_SRC

#+RESULTS:
#+NAME: table-amygdala
#+CAPTION: The relationship between EF and volume change in the amygdala
|               | t       | df       | p      | estimate (r or mean difference) |
|---------------+---------+----------+--------+---------------------------------|
| all           | 11.3538 | 300.0000 | 0.0000 | 0.5482                          |
| left          | 4.0121  | 149.0000 | 0.0001 | 0.3122                          |
| right         | 4.0207  | 149.0000 | 0.0001 | 0.3129                          |
| paired-t-test | 13.5849 | 150.0000 | 0.0000 | 0.0287                   

* Figures

#+CAPTION: Illustration of the methods. We have analyzed longitudinal structural MRI data from 151 individuals. We have calculated the volume change and the magnitude of  electrical field in 85 regions across the human cortex and subcortical structures.    
#+NAME: fig:METHODS
[[./Figures/Figure_Method.png]]

#+CAPTION: Volume change across 85 brain regions. Upper panel first row: mean EF across 85 brain regions; second row: the effect size of volume changes between baseline and at the end of the course of ECT across 85 regions. Lower panel, left: As expected, effect sizes of right unilateral stimulations were consistently higher on the right side than on the left side. Lower panel, right: The scatter plot indicates strong correlation between regional EF a regional volume change (r = {{{r}}}; p = {{{p}}}; df = {{{df}}}; t = {{{t}}}.  
#+NAME: fig:VOL-CHANGE_85ROI
[[./Figures/Figure_small_ROI_based_volume_change.png]]

#+CAPTION: Laterality Indices of EF (upper) and Volume change (lower): effect size of the paired wise difference across regions. Lower panel indicates the correlation among the laterality indices of EF and volume changes (r = {{{r_1}}}; p = {{{p_1}}}; df = {{{df_1}}}; t = {{{t_1}}}). The correlation indicates that the more the EF lateralized, the more the corresponding volume change as well.    
#+NAME: fig:LAT-IND_42ROI
[[./Figures/Figure_LatInd_42ROI.png]]


#+CAPTION: Individual specific relationship between EF and volume change in the hippocampus. The left panel indicates that there is a strong dose dependent relationship between EF and volume change in the hippocampus (t = src_R[:eval q :var t=table-hippocampus[2,1]]{t}, df = src_R[:eval q :var df=table-hippocampus[2,2]]{df}, r = src_R[:eval q :var r=table-hippocampus[2,4]]{r}, p = src_R[:eval q :var mp=table-hippocampus[2,3]]{mp} ). The left side (orange dots) has a very robust relationship (t = src_R[:eval q :var t=table-hippocampus[3,1]]{t}, df = src_R[:eval q :var df=table-hippocampus[3,2]]{df}, r = src_R[:eval q :var r=table-hippocampus[3,4]]{r}, p = src_R[:eval q :var mp=table-hippocampus[3,3]]{mp}) , and event though this relationship on the right side is not significant (probably due to ceiling effect) (t = src_R[:eval q :var t=table-hippocampus[4,1]]{t}, df = src_R[:eval q :var df=table-hippocampus[4,2]]{df}, r = src_R[:eval q :var r=table-hippocampus[4,4]]{r}, p = src_R[:eval q :var mp=table-hippocampus[4,3]]{mp})  it scales nicely with the left sided values. The right panel shows the volume changes in the corresponding individuals in both hemispheres (t = src_R[:eval q :var t=table-hippocampus[5,1]]{t}, df = src_R[:eval q :var df=table-hippocampus[5,2]]{df}, mean difference = src_R[:eval q :var r=table-hippocampus[5,4]]{r}, p = src_R[:eval q :var mp=table-hippocampus[5,3]]{mp} . 
#+NAME: fig:EFvVOLinHIPPOCAMPUS
[[./Figures/v2-EF_v_Hippocampus.png]]

#+CAPTION: Individual specific relationship between EF and volume change in the amygdala. The left panel indicates that there is a strong dose dependent relationship between EF and volume change in the amygdala (t = src_R[:eval q :var t=table-amygdala[2,1]]{t}, df = src_R[:eval q :var df=table-amygdala[2,2]]{df}, r = src_R[:eval q :var r=table-amygdala[2,4]]{r}, p = src_R[:eval q :var mp=table-amygdala[2,3]]{mp} ). Both the left (orange dots) and right (blue dots) side has a very robust relationship (t = src_R[:eval q :var t=table-amygdala[3,1]]{t}, df = src_R[:eval q :var df=table-amygdala[3,2]]{df}, r = src_R[:eval q :var r=table-amygdala[3,4]]{r}, p = src_R[:eval q :var mp=table-amygdala[3,3]]{mp}) and (t = src_R[:eval q :var t=table-amygdala[4,1]]{t}, df = src_R[:eval q :var df=table-amygdala[4,2]]{df}, r = src_R[:eval q :var r=table-amygdala[4,4]]{r}, p = src_R[:eval q :var mp=table-amygdala[4,3]]{mp}) respectively. The right panel shows the volume changes in the corresponding individuals in both hemispheres (t = src_R[:eval q :var t=table-amygdala[5,1]]{t}, df = src_R[:eval q :var df=table-amygdala[5,2]]{df}, mean difference = src_R[:eval q :var r=table-amygdala[5,4]]{r}, p = src_R[:eval q :var mp=table-amygdala[5,3]]{mp} . 
#+NAME: fig:EFvVOLinAmygdala
[[./Figures/v2-EF_v_Amygdala.png]]

* Supplementary Figures
#+CAPTION: EF and Volume specificity. To test the specificity of our measures in the left amygdala and the left hippocampus (FDR corrected findings) we permutated the labels across the 85 ROIs. First in the volume changes (left panel) and then in the EF values (right panel) and calculated correlations between the  EF and volume change of these regions respectively. This way we received 85 different values, where one of them was the "correct" correlation, indicated with red dots. The correlations between the EF and corresponding volume outperformed the other correlations (were in the top 5 percentile) from non-matching pairs, indicating that our findings were not merely a general correlation with some average values across regions, further strengthening the casual link between EF and volume change.  
#+NAME: fig:EF-VOL-spec-3ROI
[[./Figures/EF-Volume-Specificity.png]]

* Supplementary Tables
** Supplementary Table 1
#+BEGIN_SRC R :results output raw :exports results

library(ascii)
library(stringr)
mt<-read.csv('/nethome/amiklos/argyelan@gmail.com/projects/ECT/Bergen/ECTEF_collaboration/RULcorrelation/N156_dVOL_one_sample_t.csv')[,c(2:7)]
mt$roi<-str_replace(mt$roi,'EF','\\\\Delta VOL')
mt.asc<-ascii(mt, colnames=colnames(mt),digits=4, caption="Volume changes")
print(mt.asc,type="org")

#+END_SRC

#+RESULTS:
#+CAPTION: Volume changes
|    | X       | roi                                        | t       | p      | mean   | d      | BH_FDR |
|----+---------+--------------------------------------------+---------+--------+--------+--------+--------|
| 1  | 1.0000  | \Delta VOL_Left.Cerebellum.Cortex          | 0.5245  | 0.6007 | 0.0006 | 0.0427 | 0.6007 |
| 2  | 2.0000  | \Delta VOL_Left.Thalamus.Proper            | 10.5829 | 0.0000 | 0.0100 | 0.8612 | 0.0000 |
| 3  | 3.0000  | \Delta VOL_Left.Caudate                    | 6.7938  | 0.0000 | 0.0118 | 0.5529 | 0.0000 |
| 4  | 4.0000  | \Delta VOL_Left.Putamen                    | 4.9404  | 0.0000 | 0.0088 | 0.4020 | 0.0000 |
| 5  | 5.0000  | \Delta VOL_Left.Pallidum                   | 8.7126  | 0.0000 | 0.0089 | 0.7090 | 0.0000 |
| 6  | 6.0000  | \Delta VOL_Brain.Stem                      | 1.9608  | 0.0518 | 0.0016 | 0.1596 | 0.0530 |
| 7  | 7.0000  | \Delta VOL_Left.Hippocampus                | 9.0893  | 0.0000 | 0.0157 | 0.7497 | 0.0000 |
| 8  | 8.0000  | \Delta VOL_Left.Amygdala                   | 12.7007 | 0.0000 | 0.0231 | 1.0336 | 0.0000 |
| 9  | 9.0000  | \Delta VOL_Left.Accumbens.area             | 5.9768  | 0.0000 | 0.0112 | 0.4864 | 0.0000 |
| 10 | 10.0000 | \Delta VOL_Left.VentralDC                  | 5.3281  | 0.0000 | 0.0043 | 0.4336 | 0.0000 |
| 11 | 11.0000 | \Delta VOL_Right.Cerebellum.Cortex         | 0.5627  | 0.5745 | 0.0006 | 0.0458 | 0.5813 |
| 12 | 12.0000 | \Delta VOL_Right.Thalamus.Proper           | 15.0997 | 0.0000 | 0.0137 | 1.2288 | 0.0000 |
| 13 | 13.0000 | \Delta VOL_Right.Caudate                   | 9.4496  | 0.0000 | 0.0138 | 0.7690 | 0.0000 |
| 14 | 14.0000 | \Delta VOL_Right.Putamen                   | 12.1218 | 0.0000 | 0.0136 | 0.9865 | 0.0000 |
| 15 | 15.0000 | \Delta VOL_Right.Pallidum                  | 13.5065 | 0.0000 | 0.0125 | 1.0991 | 0.0000 |
| 16 | 16.0000 | \Delta VOL_Right.Hippocampus               | 16.3659 | 0.0000 | 0.0270 | 1.3498 | 0.0000 |
| 17 | 17.0000 | \Delta VOL_Right.Amygdala                  | 21.7232 | 0.0000 | 0.0518 | 1.7678 | 0.0000 |
| 18 | 18.0000 | \Delta VOL_Right.Accumbens.area            | 12.0922 | 0.0000 | 0.0214 | 0.9840 | 0.0000 |
| 19 | 19.0000 | \Delta VOL_Right.VentralDC                 | 7.7591  | 0.0000 | 0.0059 | 0.6314 | 0.0000 |
| 20 | 20.0000 | \Delta VOL_ctx.lh.bankssts                 | 7.6089  | 0.0000 | 0.0113 | 0.6192 | 0.0000 |
| 21 | 21.0000 | \Delta VOL_ctx.lh.caudalanteriorcingulate  | 11.2581 | 0.0000 | 0.0191 | 0.9162 | 0.0000 |
| 22 | 22.0000 | \Delta VOL_ctx.lh.caudalmiddlefrontal      | 8.2731  | 0.0000 | 0.0104 | 0.6733 | 0.0000 |
| 23 | 23.0000 | \Delta VOL_ctx.lh.cuneus                   | 5.9459  | 0.0000 | 0.0055 | 0.4839 | 0.0000 |
| 24 | 24.0000 | \Delta VOL_ctx.lh.entorhinal               | 7.5440  | 0.0000 | 0.0186 | 0.6139 | 0.0000 |
| 25 | 25.0000 | \Delta VOL_ctx.lh.fusiform                 | 9.5890  | 0.0000 | 0.0115 | 0.7803 | 0.0000 |
| 26 | 26.0000 | \Delta VOL_ctx.lh.inferiorparietal         | 8.6539  | 0.0000 | 0.0120 | 0.7042 | 0.0000 |
| 27 | 27.0000 | \Delta VOL_ctx.lh.inferiortemporal         | 8.2009  | 0.0000 | 0.0130 | 0.6674 | 0.0000 |
| 28 | 28.0000 | \Delta VOL_ctx.lh.isthmuscingulate         | 3.2406  | 0.0015 | 0.0037 | 0.2637 | 0.0016 |
| 29 | 29.0000 | \Delta VOL_ctx.lh.lateraloccipital         | 7.4697  | 0.0000 | 0.0086 | 0.6079 | 0.0000 |
| 30 | 30.0000 | \Delta VOL_ctx.lh.lateralorbitofrontal     | 3.6184  | 0.0004 | 0.0048 | 0.2945 | 0.0004 |
| 31 | 31.0000 | \Delta VOL_ctx.lh.lingual                  | 6.4193  | 0.0000 | 0.0053 | 0.5224 | 0.0000 |
| 32 | 32.0000 | \Delta VOL_ctx.lh.medialorbitofrontal      | 3.3268  | 0.0011 | 0.0047 | 0.2707 | 0.0012 |
| 33 | 33.0000 | \Delta VOL_ctx.lh.middletemporal           | 5.3903  | 0.0000 | 0.0098 | 0.4387 | 0.0000 |
| 34 | 34.0000 | \Delta VOL_ctx.lh.parahippocampal          | 9.0527  | 0.0000 | 0.0143 | 0.7367 | 0.0000 |
| 35 | 35.0000 | \Delta VOL_ctx.lh.paracentral              | 9.9337  | 0.0000 | 0.0120 | 0.8084 | 0.0000 |
| 36 | 36.0000 | \Delta VOL_ctx.lh.parsopercularis          | 9.9665  | 0.0000 | 0.0123 | 0.8111 | 0.0000 |
| 37 | 37.0000 | \Delta VOL_ctx.lh.parsorbitalis            | 2.6751  | 0.0083 | 0.0048 | 0.2177 | 0.0087 |
| 38 | 38.0000 | \Delta VOL_ctx.lh.parstriangularis         | 6.5027  | 0.0000 | 0.0091 | 0.5292 | 0.0000 |
| 39 | 39.0000 | \Delta VOL_ctx.lh.pericalcarine            | 5.7835  | 0.0000 | 0.0053 | 0.4707 | 0.0000 |
| 40 | 40.0000 | \Delta VOL_ctx.lh.postcentral              | 6.7211  | 0.0000 | 0.0064 | 0.5470 | 0.0000 |
| 41 | 41.0000 | \Delta VOL_ctx.lh.posteriorcingulate       | 6.7536  | 0.0000 | 0.0078 | 0.5496 | 0.0000 |
| 42 | 42.0000 | \Delta VOL_ctx.lh.precentral               | 9.5193  | 0.0000 | 0.0098 | 0.7747 | 0.0000 |
| 43 | 43.0000 | \Delta VOL_ctx.lh.precuneus                | 7.0412  | 0.0000 | 0.0069 | 0.5730 | 0.0000 |
| 44 | 44.0000 | \Delta VOL_ctx.lh.rostralanteriorcingulate | 5.9032  | 0.0000 | 0.0098 | 0.4804 | 0.0000 |
| 45 | 45.0000 | \Delta VOL_ctx.lh.rostralmiddlefrontal     | 5.0290  | 0.0000 | 0.0063 | 0.4093 | 0.0000 |
| 46 | 46.0000 | \Delta VOL_ctx.lh.superiorfrontal          | 8.5848  | 0.0000 | 0.0111 | 0.6986 | 0.0000 |
| 47 | 47.0000 | \Delta VOL_ctx.lh.superiorparietal         | 8.4914  | 0.0000 | 0.0090 | 0.6910 | 0.0000 |
| 48 | 48.0000 | \Delta VOL_ctx.lh.superiortemporal         | 5.8041  | 0.0000 | 0.0084 | 0.4723 | 0.0000 |
| 49 | 49.0000 | \Delta VOL_ctx.lh.supramarginal            | 9.4186  | 0.0000 | 0.0126 | 0.7665 | 0.0000 |
| 50 | 50.0000 | \Delta VOL_ctx.lh.frontalpole              | 2.3865  | 0.0183 | 0.0070 | 0.1942 | 0.0189 |
| 51 | 51.0000 | \Delta VOL_ctx.lh.temporalpole             | 8.2492  | 0.0000 | 0.0222 | 0.6713 | 0.0000 |
| 52 | 52.0000 | \Delta VOL_ctx.lh.transversetemporal       | 4.3494  | 0.0000 | 0.0068 | 0.3540 | 0.0000 |
| 53 | 53.0000 | \Delta VOL_ctx.rh.bankssts                 | 11.6196 | 0.0000 | 0.0158 | 0.9456 | 0.0000 |
| 54 | 54.0000 | \Delta VOL_ctx.rh.caudalanteriorcingulate  | 14.1234 | 0.0000 | 0.0199 | 1.1493 | 0.0000 |
| 55 | 55.0000 | \Delta VOL_ctx.rh.caudalmiddlefrontal      | 9.3625  | 0.0000 | 0.0115 | 0.7619 | 0.0000 |
| 56 | 56.0000 | \Delta VOL_ctx.rh.cuneus                   | 8.2941  | 0.0000 | 0.0073 | 0.6750 | 0.0000 |
| 57 | 57.0000 | \Delta VOL_ctx.rh.entorhinal               | 13.2836 | 0.0000 | 0.0330 | 1.0810 | 0.0000 |
| 58 | 58.0000 | \Delta VOL_ctx.rh.fusiform                 | 14.6356 | 0.0000 | 0.0187 | 1.1910 | 0.0000 |
| 59 | 59.0000 | \Delta VOL_ctx.rh.inferiorparietal         | 9.7739  | 0.0000 | 0.0130 | 0.7954 | 0.0000 |
| 60 | 60.0000 | \Delta VOL_ctx.rh.inferiortemporal         | 14.2156 | 0.0000 | 0.0193 | 1.1568 | 0.0000 |
| 61 | 61.0000 | \Delta VOL_ctx.rh.isthmuscingulate         | 4.1816  | 0.0000 | 0.0040 | 0.3403 | 0.0001 |
| 62 | 62.0000 | \Delta VOL_ctx.rh.lateraloccipital         | 8.2511  | 0.0000 | 0.0103 | 0.6715 | 0.0000 |
| 63 | 63.0000 | \Delta VOL_ctx.rh.lateralorbitofrontal     | 6.4489  | 0.0000 | 0.0103 | 0.5248 | 0.0000 |
| 64 | 64.0000 | \Delta VOL_ctx.rh.lingual                  | 9.1881  | 0.0000 | 0.0075 | 0.7477 | 0.0000 |
| 65 | 65.0000 | \Delta VOL_ctx.rh.medialorbitofrontal      | 7.5171  | 0.0000 | 0.0115 | 0.6117 | 0.0000 |
| 66 | 66.0000 | \Delta VOL_ctx.rh.middletemporal           | 11.6007 | 0.0000 | 0.0159 | 0.9440 | 0.0000 |
| 67 | 67.0000 | \Delta VOL_ctx.rh.parahippocampal          | 12.4883 | 0.0000 | 0.0215 | 1.0197 | 0.0000 |
| 68 | 68.0000 | \Delta VOL_ctx.rh.paracentral              | 11.6424 | 0.0000 | 0.0132 | 0.9474 | 0.0000 |
| 69 | 69.0000 | \Delta VOL_ctx.rh.parsopercularis          | 9.2831  | 0.0000 | 0.0122 | 0.7555 | 0.0000 |
| 70 | 70.0000 | \Delta VOL_ctx.rh.parsorbitalis            | 4.8321  | 0.0000 | 0.0090 | 0.3932 | 0.0000 |
| 71 | 71.0000 | \Delta VOL_ctx.rh.parstriangularis         | 9.7651  | 0.0000 | 0.0124 | 0.7947 | 0.0000 |
| 72 | 72.0000 | \Delta VOL_ctx.rh.pericalcarine            | 7.9260  | 0.0000 | 0.0068 | 0.6450 | 0.0000 |
| 73 | 73.0000 | \Delta VOL_ctx.rh.postcentral              | 7.9663  | 0.0000 | 0.0081 | 0.6483 | 0.0000 |
| 74 | 74.0000 | \Delta VOL_ctx.rh.posteriorcingulate       | 8.4401  | 0.0000 | 0.0094 | 0.6868 | 0.0000 |
| 75 | 75.0000 | \Delta VOL_ctx.rh.precentral               | 9.5727  | 0.0000 | 0.0105 | 0.7790 | 0.0000 |
| 76 | 76.0000 | \Delta VOL_ctx.rh.precuneus                | 9.0177  | 0.0000 | 0.0082 | 0.7339 | 0.0000 |
| 77 | 77.0000 | \Delta VOL_ctx.rh.rostralanteriorcingulate | 12.6172 | 0.0000 | 0.0184 | 1.0268 | 0.0000 |
| 78 | 78.0000 | \Delta VOL_ctx.rh.rostralmiddlefrontal     | 7.1486  | 0.0000 | 0.0092 | 0.5817 | 0.0000 |
| 79 | 79.0000 | \Delta VOL_ctx.rh.superiorfrontal          | 9.3432  | 0.0000 | 0.0118 | 0.7603 | 0.0000 |
| 80 | 80.0000 | \Delta VOL_ctx.rh.superiorparietal         | 7.1766  | 0.0000 | 0.0086 | 0.5840 | 0.0000 |
| 81 | 81.0000 | \Delta VOL_ctx.rh.superiortemporal         | 15.6352 | 0.0000 | 0.0216 | 1.2724 | 0.0000 |
| 82 | 82.0000 | \Delta VOL_ctx.rh.supramarginal            | 12.4385 | 0.0000 | 0.0153 | 1.0122 | 0.0000 |
| 83 | 83.0000 | \Delta VOL_ctx.rh.frontalpole              | 3.5531  | 0.0005 | 0.0089 | 0.2891 | 0.0006 |
| 84 | 84.0000 | \Delta VOL_ctx.rh.temporalpole             | 15.0638 | 0.0000 | 0.0442 | 1.2259 | 0.0000 |
| 85 | 85.0000 | \Delta VOL_ctx.rh.transversetemporal       | 9.8355  | 0.0000 | 0.0159 | 0.8004 | 0.0000 |

** Supplementary Table 2
#+BEGIN_SRC R :results output raw :exports results

  library(ascii)
  library(stringr)
  mt<-read.csv('/nethome/amiklos/argyelan@gmail.com/projects/ECT/Bergen/ECTEF_collaboration/RULcorrelation/N156_dVOL_paired_sample_t_R_L.csv')[,c(2:6,9)]
  mt$roi<-str_replace(mt$roi,'EF','\\\\Delta VOL^{R-L}')
  mt.asc<-ascii(mt, colnames=colnames(mt),digits=4, caption="Pairwise difference in volume change between R and L side")
  print(mt.asc,type="org")

#+END_SRC

#+RESULTS:
#+CAPTION: Pairwise difference in volume change between R and L side
|    | roi                                              |       t |      p |    mean |       d | BH_FDR |
|----+--------------------------------------------------+---------+--------+---------+---------+--------|
|  1 | \Delta VOL^{R-L}_Left.Cerebellum.Cortex          |  0.0143 | 0.9886 |  0.0000 |  0.0012 | 0.9886 |
|  2 | \Delta VOL^{R-L}_Left.Thalamus.Proper            |  5.3964 | 0.0000 |  0.0038 |  0.4392 | 0.0000 |
|  3 | \Delta VOL^{R-L}_Left.Caudate                    |  1.3345 | 0.1841 |  0.0020 |  0.1086 | 0.2479 |
|  4 | \Delta VOL^{R-L}_Left.Putamen                    |  2.9475 | 0.0037 |  0.0048 |  0.2399 | 0.0082 |
|  5 | \Delta VOL^{R-L}_Left.Pallidum                   |  4.1348 | 0.0001 |  0.0036 |  0.3365 | 0.0002 |
|  6 | \Delta VOL^{R-L}_Left.Hippocampus                |  7.5495 | 0.0000 |  0.0112 |  0.6227 | 0.0000 |
|  7 | \Delta VOL^{R-L}_Left.Amygdala                   | 13.5849 | 0.0000 |  0.0287 |  1.1055 | 0.0000 |
|  8 | \Delta VOL^{R-L}_Left.Accumbens.area             |  4.9434 | 0.0000 |  0.0102 |  0.4023 | 0.0000 |
|  9 | \Delta VOL^{R-L}_Left.VentralDC                  |  2.0243 | 0.0447 |  0.0015 |  0.1647 | 0.0722 |
| 10 | \Delta VOL^{R-L}_ctx.lh.bankssts                 |  3.0130 | 0.0030 |  0.0045 |  0.2452 | 0.0071 |
| 11 | \Delta VOL^{R-L}_ctx.lh.caudalanteriorcingulate  |  0.6360 | 0.5257 |  0.0009 |  0.0518 | 0.5811 |
| 12 | \Delta VOL^{R-L}_ctx.lh.caudalmiddlefrontal      |  0.9711 | 0.3331 |  0.0011 |  0.0790 | 0.4239 |
| 13 | \Delta VOL^{R-L}_ctx.lh.cuneus                   |  2.4545 | 0.0153 |  0.0018 |  0.1997 | 0.0305 |
| 14 | \Delta VOL^{R-L}_ctx.lh.entorhinal               |  5.8721 | 0.0000 |  0.0144 |  0.4779 | 0.0000 |
| 15 | \Delta VOL^{R-L}_ctx.lh.fusiform                 |  6.5958 | 0.0000 |  0.0073 |  0.5368 | 0.0000 |
| 16 | \Delta VOL^{R-L}_ctx.lh.inferiorparietal         |  0.7300 | 0.4665 |  0.0009 |  0.0594 | 0.5296 |
| 17 | \Delta VOL^{R-L}_ctx.lh.inferiortemporal         |  4.0768 | 0.0001 |  0.0063 |  0.3318 | 0.0002 |
| 18 | \Delta VOL^{R-L}_ctx.lh.isthmuscingulate         |  0.3073 | 0.7590 |  0.0003 |  0.0250 | 0.7970 |
| 19 | \Delta VOL^{R-L}_ctx.lh.lateraloccipital         |  1.8303 | 0.0692 |  0.0017 |  0.1489 | 0.1076 |
| 20 | \Delta VOL^{R-L}_ctx.lh.lateralorbitofrontal     |  4.4129 | 0.0000 |  0.0055 |  0.3591 | 0.0001 |
| 21 | \Delta VOL^{R-L}_ctx.lh.lingual                  |  3.4261 | 0.0008 |  0.0022 |  0.2788 | 0.0020 |
| 22 | \Delta VOL^{R-L}_ctx.lh.medialorbitofrontal      |  5.6916 | 0.0000 |  0.0068 |  0.4632 | 0.0000 |
| 23 | \Delta VOL^{R-L}_ctx.lh.middletemporal           |  3.4250 | 0.0008 |  0.0061 |  0.2787 | 0.0020 |
| 24 | \Delta VOL^{R-L}_ctx.lh.parahippocampal          |  5.2481 | 0.0000 |  0.0073 |  0.4285 | 0.0000 |
| 25 | \Delta VOL^{R-L}_ctx.lh.paracentral              |  1.3198 | 0.1889 |  0.0012 |  0.1074 | 0.2479 |
| 26 | \Delta VOL^{R-L}_ctx.lh.parsopercularis          | -0.0817 | 0.9350 | -0.0001 | -0.0067 | 0.9578 |
| 27 | \Delta VOL^{R-L}_ctx.lh.parsorbitalis            |  2.2705 | 0.0246 |  0.0042 |  0.1848 | 0.0449 |
| 28 | \Delta VOL^{R-L}_ctx.lh.parstriangularis         |  2.3062 | 0.0225 |  0.0032 |  0.1877 | 0.0429 |
| 29 | \Delta VOL^{R-L}_ctx.lh.pericalcarine            |  2.1849 | 0.0304 |  0.0015 |  0.1778 | 0.0533 |
| 30 | \Delta VOL^{R-L}_ctx.lh.postcentral              |  1.6675 | 0.0975 |  0.0017 |  0.1357 | 0.1365 |
| 31 | \Delta VOL^{R-L}_ctx.lh.posteriorcingulate       |  1.7943 | 0.0748 |  0.0015 |  0.1460 | 0.1103 |
| 32 | \Delta VOL^{R-L}_ctx.lh.precentral               |  0.7771 | 0.4383 |  0.0007 |  0.0632 | 0.5116 |
| 33 | \Delta VOL^{R-L}_ctx.lh.precuneus                |  1.7855 | 0.0762 |  0.0013 |  0.1453 | 0.1103 |
| 34 | \Delta VOL^{R-L}_ctx.lh.rostralanteriorcingulate |  5.3843 | 0.0000 |  0.0086 |  0.4382 | 0.0000 |
| 35 | \Delta VOL^{R-L}_ctx.lh.rostralmiddlefrontal     |  2.7045 | 0.0076 |  0.0028 |  0.2201 | 0.0160 |
| 36 | \Delta VOL^{R-L}_ctx.lh.superiorfrontal          |  0.9084 | 0.3651 |  0.0007 |  0.0739 | 0.4511 |
| 37 | \Delta VOL^{R-L}_ctx.lh.superiorparietal         | -0.5389 | 0.5907 | -0.0004 | -0.0439 | 0.6362 |
| 38 | \Delta VOL^{R-L}_ctx.lh.superiortemporal         |  8.6326 | 0.0000 |  0.0132 |  0.7025 | 0.0000 |
| 39 | \Delta VOL^{R-L}_ctx.lh.supramarginal            |  2.1185 | 0.0358 |  0.0027 |  0.1724 | 0.0601 |
| 40 | \Delta VOL^{R-L}_ctx.lh.frontalpole              |  0.7768 | 0.4385 |  0.0019 |  0.0632 | 0.5116 |
| 41 | \Delta VOL^{R-L}_ctx.lh.temporalpole             |  6.6295 | 0.0000 |  0.0220 |  0.5395 | 0.0000 |
| 42 | \Delta VOL^{R-L}_ctx.lh.transversetemporal       |  5.8831 | 0.0000 |  0.0090 |  0.4788 | 0.0000 |
|    |                                                  |         |        |         |         |        |

** Supplementary Table 3
#+BEGIN_SRC R  :results output raw :exports results

  library(ascii)
  library(stringr)
  mt<-read.csv('/nethome/amiklos/argyelan@gmail.com/projects/ECT/Bergen/ECTEF_collaboration/RULcorrelation/N151_dVol-EF+Age+ECTnum+Site_FDRcorrect.csv')[,c(2:5,7,9)]
  mt$roi<-str_replace(mt$roi,'EF','\\\\Delta VOL')
  colnames(mt)[6]<-'BH^EF_FDR'
  mt.asc<-ascii(mt, colnames=colnames(mt),digits=4,
               caption="The relationship between volume changes and EF across individuals (EF ~ \\Delta Vol + Age + ECTnum)")
  print(mt.asc,type="org")

#+END_SRC

#+RESULTS:
#+CAPTION: The relationship between volume changes and EF across individuals (\Delta Vol ~ EF + Age + ECTnum + Site)
|    | roi                                        |    t_EF |   p_EF |   t_Age | t_ECTnum | BH^EF_FDR |
|----+--------------------------------------------+---------+--------+---------+----------+-----------|
|  1 | \Delta VOL_Left.Cerebellum.Cortex          | -0.7077 | 0.4803 | -0.8606 |   1.9517 |    0.6635 |
|  2 | \Delta VOL_Left.Thalamus.Proper            | -0.0482 | 0.9616 | -0.9813 |   2.9489 |    0.9901 |
|  3 | \Delta VOL_Left.Caudate                    |  0.5360 | 0.5928 | -1.2656 |   2.5623 |    0.7413 |
|  4 | \Delta VOL_Left.Putamen                    |  0.5448 | 0.5867 | -0.6440 |   1.1996 |    0.7413 |
|  5 | \Delta VOL_Left.Pallidum                   |  0.0240 | 0.9809 | -0.2801 |   1.3564 |    0.9901 |
|  6 | \Delta VOL_Brain.Stem                      |  1.1193 | 0.2649 |  0.7287 |   1.3294 |    0.5028 |
|  7 | \Delta VOL_Left.Hippocampus                |  4.2691 | 0.0000 | -2.5224 |   3.1914 |    0.0031 |
|  8 | \Delta VOL_Left.Amygdala                   |  3.8842 | 0.0002 | -1.5712 |   2.1318 |    0.0067 |
|  9 | \Delta VOL_Left.Accumbens.area             |  1.6782 | 0.0955 | -2.9473 |   1.8286 |    0.3284 |
| 10 | \Delta VOL_Left.VentralDC                  |  0.1894 | 0.8501 | -0.4260 |   2.3792 |    0.9146 |
| 11 | \Delta VOL_Right.Cerebellum.Cortex         | -0.9420 | 0.3478 | -0.7401 |   1.4021 |    0.5686 |
| 12 | \Delta VOL_Right.Thalamus.Proper           |  0.5230 | 0.6018 | -0.0407 |   4.3008 |    0.7413 |
| 13 | \Delta VOL_Right.Caudate                   |  1.1512 | 0.2516 |  0.4839 |   1.4988 |    0.5028 |
| 14 | \Delta VOL_Right.Putamen                   |  1.0244 | 0.3074 | -0.6953 |   1.4664 |    0.5410 |
| 15 | \Delta VOL_Right.Pallidum                  |  0.4756 | 0.6351 |  0.0747 |   2.9584 |    0.7711 |
| 16 | \Delta VOL_Right.Hippocampus               |  1.3008 | 0.1955 | -1.4707 |   3.3075 |    0.4617 |
| 17 | \Delta VOL_Right.Amygdala                  |  2.7926 | 0.0060 | -1.0910 |   4.2600 |    0.0562 |
| 18 | \Delta VOL_Right.Accumbens.area            |  1.6358 | 0.1041 | -1.2504 |   3.3451 |    0.3404 |
| 19 | \Delta VOL_Right.VentralDC                 |  0.4550 | 0.6498 |  0.3636 |   0.8634 |    0.7779 |
| 20 | \Delta VOL_ctx.lh.bankssts                 |  1.1025 | 0.2721 | -1.0035 |   2.6363 |    0.5028 |
| 21 | \Delta VOL_ctx.lh.caudalanteriorcingulate  |  1.3452 | 0.1807 | -1.8649 |   2.3493 |    0.4518 |
| 22 | \Delta VOL_ctx.lh.caudalmiddlefrontal      | -1.9393 | 0.0545 | -1.0865 |   2.0847 |    0.2251 |
| 23 | \Delta VOL_ctx.lh.cuneus                   |  0.8976 | 0.3709 | -0.7227 |   2.0824 |    0.5769 |
| 24 | \Delta VOL_ctx.lh.entorhinal               |  3.0111 | 0.0031 | -0.4146 |   0.9977 |    0.0404 |
| 25 | \Delta VOL_ctx.lh.fusiform                 |  2.9742 | 0.0035 | -0.6510 |   2.1491 |    0.0404 |
| 26 | \Delta VOL_ctx.lh.inferiorparietal         |  1.5027 | 0.1352 |  0.3126 |   2.3680 |    0.3829 |
| 27 | \Delta VOL_ctx.lh.inferiortemporal         |  2.6533 | 0.0089 |  0.0577 |   1.9325 |    0.0629 |
| 28 | \Delta VOL_ctx.lh.isthmuscingulate         | -0.5276 | 0.5986 | -1.0431 |   2.9988 |    0.7413 |
| 29 | \Delta VOL_ctx.lh.lateraloccipital         |  1.0108 | 0.3138 | -0.5696 |   1.4052 |    0.5410 |
| 30 | \Delta VOL_ctx.lh.lateralorbitofrontal     |  1.1216 | 0.2639 | -0.7869 |   1.8807 |    0.5028 |
| 31 | \Delta VOL_ctx.lh.lingual                  | -0.2389 | 0.8115 | -1.1174 |   2.5914 |    0.8920 |
| 32 | \Delta VOL_ctx.lh.medialorbitofrontal      |  1.2416 | 0.2165 | -0.7330 |   1.7153 |    0.4876 |
| 33 | \Delta VOL_ctx.lh.middletemporal           |  1.9300 | 0.0556 | -0.9504 |   2.2897 |    0.2251 |
| 34 | \Delta VOL_ctx.lh.parahippocampal          |  1.0017 | 0.3182 | -1.0607 |   2.8588 |    0.5410 |
| 35 | \Delta VOL_ctx.lh.paracentral              | -2.0256 | 0.0447 | -0.2084 |   4.0846 |    0.1999 |
| 36 | \Delta VOL_ctx.lh.parsopercularis          | -0.6296 | 0.5300 | -1.5330 |   2.0540 |    0.7039 |
| 37 | \Delta VOL_ctx.lh.parsorbitalis            |  0.8684 | 0.3867 | -2.0409 |   1.2607 |    0.5769 |
| 38 | \Delta VOL_ctx.lh.parstriangularis         |  0.8792 | 0.3808 | -1.8880 |   2.9707 |    0.5769 |
| 39 | \Delta VOL_ctx.lh.pericalcarine            |  0.2824 | 0.7781 | -0.6554 |   2.0973 |    0.8705 |
| 40 | \Delta VOL_ctx.lh.postcentral              |  0.7540 | 0.4521 | -2.0106 |   2.4845 |    0.6441 |
| 41 | \Delta VOL_ctx.lh.posteriorcingulate       | -0.8680 | 0.3869 | -1.3788 |   3.4481 |    0.5769 |
| 42 | \Delta VOL_ctx.lh.precentral               | -0.5529 | 0.5812 | -1.7390 |   2.6143 |    0.7413 |
| 43 | \Delta VOL_ctx.lh.precuneus                | -1.5318 | 0.1278 | -0.8444 |   3.7619 |    0.3746 |
| 44 | \Delta VOL_ctx.lh.rostralanteriorcingulate |  1.1861 | 0.2376 | -1.7461 |   1.0218 |    0.5028 |
| 45 | \Delta VOL_ctx.lh.rostralmiddlefrontal     | -0.7018 | 0.4839 | -2.1366 |   1.2991 |    0.6635 |
| 46 | \Delta VOL_ctx.lh.superiorfrontal          | -1.1124 | 0.2679 | -1.2162 |   2.3706 |    0.5028 |
| 47 | \Delta VOL_ctx.lh.superiorparietal         | -1.6728 | 0.0966 |  0.0639 |   3.4273 |    0.3284 |
| 48 | \Delta VOL_ctx.lh.superiortemporal         |  2.1407 | 0.0340 | -2.5610 |   1.7311 |    0.1701 |
| 49 | \Delta VOL_ctx.lh.supramarginal            |  0.6435 | 0.5209 | -0.7216 |   2.1650 |    0.7029 |
| 50 | \Delta VOL_ctx.lh.frontalpole              | -0.0377 | 0.9700 | -1.3964 |   0.5703 |    0.9901 |
| 51 | \Delta VOL_ctx.lh.temporalpole             |  2.0261 | 0.0446 | -0.7673 |   1.2379 |    0.1999 |
| 52 | \Delta VOL_ctx.lh.transversetemporal       |  0.2299 | 0.8185 | -1.5907 |   2.0586 |    0.8920 |
| 53 | \Delta VOL_ctx.rh.bankssts                 |  0.0124 | 0.9901 |  1.5361 |   3.1792 |    0.9901 |
| 54 | \Delta VOL_ctx.rh.caudalanteriorcingulate  | -1.5670 | 0.1194 |  0.5990 |   2.4298 |    0.3746 |
| 55 | \Delta VOL_ctx.rh.caudalmiddlefrontal      | -3.1057 | 0.0023 |  0.6166 |   2.9498 |    0.0404 |
| 56 | \Delta VOL_ctx.rh.cuneus                   | -0.0792 | 0.9370 | -1.7783 |   2.5751 |    0.9880 |
| 57 | \Delta VOL_ctx.rh.entorhinal               |  1.1198 | 0.2647 |  0.9036 |   2.0935 |    0.5028 |
| 58 | \Delta VOL_ctx.rh.fusiform                 |  1.4742 | 0.1427 |  0.3326 |   4.8662 |    0.3912 |
| 59 | \Delta VOL_ctx.rh.inferiorparietal         | -2.9427 | 0.0038 |  1.0381 |   0.9701 |    0.0404 |
| 60 | \Delta VOL_ctx.rh.inferiortemporal         |  0.8291 | 0.4084 |  1.2971 |   3.5573 |    0.5986 |
| 61 | \Delta VOL_ctx.rh.isthmuscingulate         |  0.0735 | 0.9415 |  0.0088 |   1.1998 |    0.9880 |
| 62 | \Delta VOL_ctx.rh.lateraloccipital         |  0.9594 | 0.3390 | -0.4039 |   1.8600 |    0.5650 |
| 63 | \Delta VOL_ctx.rh.lateralorbitofrontal     |  0.2931 | 0.7699 | -0.3566 |   2.6316 |    0.8705 |
| 64 | \Delta VOL_ctx.rh.lingual                  | -0.2821 | 0.7783 | -2.5305 |   3.6953 |    0.8705 |
| 65 | \Delta VOL_ctx.rh.medialorbitofrontal      |  0.4189 | 0.6759 |  0.7129 |   2.1749 |    0.7980 |
| 66 | \Delta VOL_ctx.rh.middletemporal           | -0.9236 | 0.3573 |  1.4818 |   3.9421 |    0.5730 |
| 67 | \Delta VOL_ctx.rh.parahippocampal          |  1.2374 | 0.2180 | -0.0103 |   3.1028 |    0.4876 |
| 68 | \Delta VOL_ctx.rh.paracentral              | -3.5214 | 0.0006 |  1.2896 |   2.3747 |    0.0164 |
| 69 | \Delta VOL_ctx.rh.parsopercularis          | -2.3008 | 0.0229 |  1.4839 |   3.0822 |    0.1296 |
| 70 | \Delta VOL_ctx.rh.parsorbitalis            |  1.1180 | 0.2655 | -0.5014 |   2.1083 |    0.5028 |
| 71 | \Delta VOL_ctx.rh.parstriangularis         | -1.4002 | 0.1636 |  0.1202 |   2.8436 |    0.4215 |
| 72 | \Delta VOL_ctx.rh.pericalcarine            |  1.3230 | 0.1880 | -0.9155 |   2.3399 |    0.4565 |
| 73 | \Delta VOL_ctx.rh.postcentral              | -1.8932 | 0.0604 |  0.7199 |   3.3344 |    0.2333 |
| 74 | \Delta VOL_ctx.rh.posteriorcingulate       | -1.5384 | 0.1262 |  0.6708 |   1.7477 |    0.3746 |
| 75 | \Delta VOL_ctx.rh.precentral               | -2.5415 | 0.0121 |  0.0520 |   3.9487 |    0.0743 |
| 76 | \Delta VOL_ctx.rh.precuneus                | -1.8647 | 0.0643 | -0.6056 |   2.7407 |    0.2376 |
| 77 | \Delta VOL_ctx.rh.rostralanteriorcingulate |  2.1630 | 0.0322 |  0.3800 |   2.5260 |    0.1701 |
| 78 | \Delta VOL_ctx.rh.rostralmiddlefrontal     | -2.6584 | 0.0088 | -0.0802 |   2.2835 |    0.0629 |
| 79 | \Delta VOL_ctx.rh.superiorfrontal          | -3.0466 | 0.0028 |  0.2680 |   3.4240 |    0.0404 |
| 80 | \Delta VOL_ctx.rh.superiorparietal         | -2.7514 | 0.0067 | -0.0851 |   2.3533 |    0.0571 |
| 81 | \Delta VOL_ctx.rh.superiortemporal         |  0.3809 | 0.7038 |  0.7922 |   4.5852 |    0.8195 |
| 82 | \Delta VOL_ctx.rh.supramarginal            | -2.5378 | 0.0122 |  1.8745 |   3.2292 |    0.0743 |
| 83 | \Delta VOL_ctx.rh.frontalpole              |  1.4509 | 0.1490 | -1.0257 |   2.0228 |    0.3959 |
| 84 | \Delta VOL_ctx.rh.temporalpole             |  0.7497 | 0.4547 | -0.3936 |   3.6825 |    0.6441 |
| 85 | \Delta VOL_ctx.rh.transversetemporal       |  1.0726 | 0.2853 | -0.0468 |   3.4598 |    0.5159 |
|    |                                            |         |        |         |          |           |

** Supplementary Table 4
#+BEGIN_SRC R :results output raw :exports results
  library(ascii)
  library(stringr)
  mt<-read.csv('/nethome/amiklos/argyelan@gmail.com/projects/ECT/Bergen/ECTEF_collaboration/RULcorrelation/N156_dMADRSperc-dVol+Age+ECTnum+Site.csv')[,c(2:5,7)]
  mt$roi<-str_replace(mt$roi,'EF','\\\\Delta MADRS ~ \\\\Delta VOL')

  colnames(mt)[c(2:5)]<-c('t_VOL','p_VOL','t_Age','t_ECTnum')
  mt.asc<-ascii(mt, colnames=colnames(mt),digits=4,
               caption="The relationship clinical response and volume changes across individuals (\\Delta MADRS ~ \\Delta Vol + Age + ECTnum + Site)")

  print(mt.asc,type="org")

#+END_SRC

#+RESULTS:
#+CAPTION: The relationship clinical response and volume changes across individuals (\Delta MADRS ~ \Delta Vol + Age + ECTnum + Site)
|    | roi                                                       | t_VOL   | p_VOL  | t_Age  | t_ECTnum |
|----+-----------------------------------------------------------+---------+--------+--------+----------|
| 1  | \Delta MADRS ~ \Delta VOL_Left.Cerebellum.Cortex          | -0.8159 | 0.4159 | 2.4970 | -2.7965  |
| 2  | \Delta MADRS ~ \Delta VOL_Left.Thalamus.Proper            | 0.3803  | 0.7043 | 2.5724 | -2.9688  |
| 3  | \Delta MADRS ~ \Delta VOL_Left.Caudate                    | -1.2435 | 0.2157 | 2.3922 | -2.6542  |
| 4  | \Delta MADRS ~ \Delta VOL_Left.Putamen                    | 0.0762  | 0.9394 | 2.5478 | -2.9562  |
| 5  | \Delta MADRS ~ \Delta VOL_Left.Pallidum                   | -0.5278 | 0.5985 | 2.5374 | -2.8869  |
| 6  | \Delta MADRS ~ \Delta VOL_Brain.Stem                      | 0.3179  | 0.7510 | 2.5300 | -2.9811  |
| 7  | \Delta MADRS ~ \Delta VOL_Left.Hippocampus                | 0.0438  | 0.9651 | 2.4872 | -2.7122  |
| 8  | \Delta MADRS ~ \Delta VOL_Left.Amygdala                   | -0.4254 | 0.6712 | 2.4191 | -2.8678  |
| 9  | \Delta MADRS ~ \Delta VOL_Left.Accumbens.area             | -1.2584 | 0.2103 | 2.1589 | -2.7525  |
| 10 | \Delta MADRS ~ \Delta VOL_Left.VentralDC                  | -0.2899 | 0.7723 | 2.5358 | -2.8498  |
| 11 | \Delta MADRS ~ \Delta VOL_Right.Cerebellum.Cortex         | 0.1157  | 0.9081 | 2.5511 | -2.9561  |
| 12 | \Delta MADRS ~ \Delta VOL_Right.Thalamus.Proper           | 1.6058  | 0.1105 | 2.5791 | -3.3579  |
| 13 | \Delta MADRS ~ \Delta VOL_Right.Caudate                   | -0.1530 | 0.8787 | 2.5529 | -2.9223  |
| 14 | \Delta MADRS ~ \Delta VOL_Right.Putamen                   | -1.4137 | 0.1597 | 2.4802 | -2.7971  |
| 15 | \Delta MADRS ~ \Delta VOL_Right.Pallidum                  | -0.2001 | 0.8417 | 2.5500 | -2.8283  |
| 16 | \Delta MADRS ~ \Delta VOL_Right.Hippocampus               | -0.8698 | 0.3859 | 2.4519 | -2.4505  |
| 17 | \Delta MADRS ~ \Delta VOL_Right.Amygdala                  | 1.1161  | 0.2663 | 2.6417 | -3.1749  |
| 18 | \Delta MADRS ~ \Delta VOL_Right.Accumbens.area            | -0.4149 | 0.6789 | 2.5065 | -2.7461  |
| 19 | \Delta MADRS ~ \Delta VOL_Right.VentralDC                 | -0.3803 | 0.7043 | 2.5596 | -2.9306  |
| 20 | \Delta MADRS ~ \Delta VOL_ctx.lh.bankssts                 | -1.3143 | 0.1909 | 2.4005 | -2.6384  |
| 21 | \Delta MADRS ~ \Delta VOL_ctx.lh.caudalanteriorcingulate  | 0.6706  | 0.5036 | 2.6238 | -3.0414  |
| 22 | \Delta MADRS ~ \Delta VOL_ctx.lh.caudalmiddlefrontal      | -0.5397 | 0.5903 | 2.4958 | -2.8214  |
| 23 | \Delta MADRS ~ \Delta VOL_ctx.lh.cuneus                   | 0.5126  | 0.6090 | 2.5799 | -3.0098  |
| 24 | \Delta MADRS ~ \Delta VOL_ctx.lh.entorhinal               | 0.0747  | 0.9405 | 2.5494 | -2.9577  |
| 25 | \Delta MADRS ~ \Delta VOL_ctx.lh.fusiform                 | 1.2700  | 0.2062 | 2.6364 | -3.1500  |
| 26 | \Delta MADRS ~ \Delta VOL_ctx.lh.inferiorparietal         | -0.4188 | 0.6760 | 2.5568 | -2.8352  |
| 27 | \Delta MADRS ~ \Delta VOL_ctx.lh.inferiortemporal         | -0.1482 | 0.8824 | 2.5446 | -2.9097  |
| 28 | \Delta MADRS ~ \Delta VOL_ctx.lh.isthmuscingulate         | 0.0668  | 0.9469 | 2.5454 | -2.8863  |
| 29 | \Delta MADRS ~ \Delta VOL_ctx.lh.lateraloccipital         | 0.2522  | 0.8012 | 2.5595 | -2.9732  |
| 30 | \Delta MADRS ~ \Delta VOL_ctx.lh.lateralorbitofrontal     | -0.3648 | 0.7158 | 2.5145 | -2.8766  |
| 31 | \Delta MADRS ~ \Delta VOL_ctx.lh.lingual                  | 0.9774  | 0.3300 | 2.6374 | -3.1140  |
| 32 | \Delta MADRS ~ \Delta VOL_ctx.lh.medialorbitofrontal      | -0.1897 | 0.8498 | 2.5328 | -2.9130  |
| 33 | \Delta MADRS ~ \Delta VOL_ctx.lh.middletemporal           | -1.2869 | 0.2002 | 2.3992 | -2.7005  |
| 34 | \Delta MADRS ~ \Delta VOL_ctx.lh.parahippocampal          | 1.1467  | 0.2534 | 2.6544 | -3.1609  |
| 35 | \Delta MADRS ~ \Delta VOL_ctx.lh.paracentral              | 0.0138  | 0.9890 | 2.5474 | -2.8063  |
| 36 | \Delta MADRS ~ \Delta VOL_ctx.lh.parsopercularis          | -0.7951 | 0.4279 | 2.4369 | -2.7884  |
| 37 | \Delta MADRS ~ \Delta VOL_ctx.lh.parsorbitalis            | -1.2866 | 0.2004 | 2.2743 | -2.8337  |
| 38 | \Delta MADRS ~ \Delta VOL_ctx.lh.parstriangularis         | -1.5848 | 0.1152 | 2.2654 | -2.5210  |
| 39 | \Delta MADRS ~ \Delta VOL_ctx.lh.pericalcarine            | 0.8398  | 0.4025 | 2.5998 | -3.0708  |
| 40 | \Delta MADRS ~ \Delta VOL_ctx.lh.postcentral              | -1.4048 | 0.1623 | 2.3034 | -2.6409  |
| 41 | \Delta MADRS ~ \Delta VOL_ctx.lh.posteriorcingulate       | 0.1186  | 0.9058 | 2.5425 | -2.8750  |
| 42 | \Delta MADRS ~ \Delta VOL_ctx.lh.precentral               | -0.4508 | 0.6528 | 2.4572 | -2.7958  |
| 43 | \Delta MADRS ~ \Delta VOL_ctx.lh.precuneus                | 0.0981  | 0.9220 | 2.5495 | -2.8463  |
| 44 | \Delta MADRS ~ \Delta VOL_ctx.lh.rostralanteriorcingulate | -0.2813 | 0.7789 | 2.4718 | -2.9327  |
| 45 | \Delta MADRS ~ \Delta VOL_ctx.lh.rostralmiddlefrontal     | -2.3505 | 0.0201 | 2.1591 | -2.7368  |
| 46 | \Delta MADRS ~ \Delta VOL_ctx.lh.superiorfrontal          | -0.5910 | 0.5555 | 2.4791 | -2.7921  |
| 47 | \Delta MADRS ~ \Delta VOL_ctx.lh.superiorparietal         | -0.3451 | 0.7305 | 2.5493 | -2.7497  |
| 48 | \Delta MADRS ~ \Delta VOL_ctx.lh.superiortemporal         | -0.9754 | 0.3310 | 2.2232 | -2.8132  |
| 49 | \Delta MADRS ~ \Delta VOL_ctx.lh.supramarginal            | -0.3053 | 0.7606 | 2.5243 | -2.8646  |
| 50 | \Delta MADRS ~ \Delta VOL_ctx.lh.frontalpole              | -1.5128 | 0.1326 | 2.3742 | -2.9102  |
| 51 | \Delta MADRS ~ \Delta VOL_ctx.lh.temporalpole             | -0.5220 | 0.6025 | 2.5121 | -2.8943  |
| 52 | \Delta MADRS ~ \Delta VOL_ctx.lh.transversetemporal       | -0.0410 | 0.9673 | 2.5153 | -2.9130  |
| 53 | \Delta MADRS ~ \Delta VOL_ctx.rh.bankssts                 | 1.0544  | 0.2935 | 2.4003 | -3.1466  |
| 54 | \Delta MADRS ~ \Delta VOL_ctx.rh.caudalanteriorcingulate  | -0.0699 | 0.9444 | 2.5484 | -2.8906  |
| 55 | \Delta MADRS ~ \Delta VOL_ctx.rh.caudalmiddlefrontal      | -1.1173 | 0.2658 | 2.6018 | -2.6252  |
| 56 | \Delta MADRS ~ \Delta VOL_ctx.rh.cuneus                   | 1.6882  | 0.0936 | 2.7956 | -3.2841  |
| 57 | \Delta MADRS ~ \Delta VOL_ctx.rh.entorhinal               | 0.1265  | 0.8995 | 2.5284 | -2.9416  |
| 58 | \Delta MADRS ~ \Delta VOL_ctx.rh.fusiform                 | 1.8055  | 0.0731 | 2.5182 | -3.4519  |
| 59 | \Delta MADRS ~ \Delta VOL_ctx.rh.inferiorparietal         | 0.5861  | 0.5588 | 2.4842 | -3.0097  |
| 60 | \Delta MADRS ~ \Delta VOL_ctx.rh.inferiortemporal         | 1.3803  | 0.1697 | 2.4002 | -3.2533  |
| 61 | \Delta MADRS ~ \Delta VOL_ctx.rh.isthmuscingulate         | -0.4382 | 0.6619 | 2.5502 | -2.9061  |
| 62 | \Delta MADRS ~ \Delta VOL_ctx.rh.lateraloccipital         | 0.7895  | 0.4311 | 2.5874 | -3.0540  |
| 63 | \Delta MADRS ~ \Delta VOL_ctx.rh.lateralorbitofrontal     | -0.2986 | 0.7657 | 2.5398 | -2.8305  |
| 64 | \Delta MADRS ~ \Delta VOL_ctx.rh.lingual                  | 1.1723  | 0.2431 | 2.7481 | -3.1918  |
| 65 | \Delta MADRS ~ \Delta VOL_ctx.rh.medialorbitofrontal      | -0.8364 | 0.4044 | 2.6014 | -2.7752  |
| 66 | \Delta MADRS ~ \Delta VOL_ctx.rh.middletemporal           | -0.4179 | 0.6767 | 2.5828 | -2.6866  |
| 67 | \Delta MADRS ~ \Delta VOL_ctx.rh.parahippocampal          | 0.7784  | 0.4376 | 2.5784 | -3.0472  |
| 68 | \Delta MADRS ~ \Delta VOL_ctx.rh.paracentral              | -0.2366 | 0.8133 | 2.5589 | -2.8537  |
| 69 | \Delta MADRS ~ \Delta VOL_ctx.rh.parsopercularis          | -1.3880 | 0.1673 | 2.7090 | -2.5169  |
| 70 | \Delta MADRS ~ \Delta VOL_ctx.rh.parsorbitalis            | -0.5608 | 0.5758 | 2.5088 | -2.8376  |
| 71 | \Delta MADRS ~ \Delta VOL_ctx.rh.parstriangularis         | -0.8505 | 0.3965 | 2.5697 | -2.6889  |
| 72 | \Delta MADRS ~ \Delta VOL_ctx.rh.pericalcarine            | 0.4491  | 0.6541 | 2.5822 | -2.9972  |
| 73 | \Delta MADRS ~ \Delta VOL_ctx.rh.postcentral              | -0.6832 | 0.4956 | 2.5779 | -2.6697  |
| 74 | \Delta MADRS ~ \Delta VOL_ctx.rh.posteriorcingulate       | 0.2298  | 0.8185 | 2.5389 | -2.9631  |
| 75 | \Delta MADRS ~ \Delta VOL_ctx.rh.precentral               | -0.7629 | 0.4468 | 2.5321 | -2.5803  |
| 76 | \Delta MADRS ~ \Delta VOL_ctx.rh.precuneus                | 0.9296  | 0.3542 | 2.6022 | -3.1080  |
| 77 | \Delta MADRS ~ \Delta VOL_ctx.rh.rostralanteriorcingulate | -0.5961 | 0.5521 | 2.5520 | -2.8063  |
| 78 | \Delta MADRS ~ \Delta VOL_ctx.rh.rostralmiddlefrontal     | -2.0552 | 0.0417 | 2.5896 | -2.5381  |
| 79 | \Delta MADRS ~ \Delta VOL_ctx.rh.superiorfrontal          | -0.8254 | 0.4105 | 2.5580 | -2.6422  |
| 80 | \Delta MADRS ~ \Delta VOL_ctx.rh.superiorparietal         | -0.1364 | 0.8917 | 2.5455 | -2.8742  |
| 81 | \Delta MADRS ~ \Delta VOL_ctx.rh.superiortemporal         | 0.1343  | 0.8934 | 2.5337 | -2.8135  |
| 82 | \Delta MADRS ~ \Delta VOL_ctx.rh.supramarginal            | 0.4538  | 0.6506 | 2.4526 | -2.9774  |
| 83 | \Delta MADRS ~ \Delta VOL_ctx.rh.frontalpole              | -0.8419 | 0.4013 | 2.4889 | -2.8006  |
| 84 | \Delta MADRS ~ \Delta VOL_ctx.rh.temporalpole             | -0.6126 | 0.5411 | 2.5318 | -2.6560  |
| 85 | \Delta MADRS ~ \Delta VOL_ctx.rh.transversetemporal       | 1.0526  | 0.2943 | 2.5712 | -3.1486  |

** Supplementary Table 5
#+BEGIN_SRC R :results output raw :exports results
  library(ascii)
  library(stringr)
  mt<-read.csv('/nethome/amiklos/argyelan@gmail.com/projects/ECT/Bergen/ECTEF_collaboration/RULcorrelation/N156_dMADRS-EF+Age+ECTnum+Site.csv')[,c(2:5,7)]
  mt$roi<-str_replace(mt$roi,'EF','\\\\Delta MADRS ~ EF')

  colnames(mt)[c(2:5)]<-c('t_EF','p_EF','t_Age','t_ECTnum')
  mt.asc<-ascii(mt, colnames=colnames(mt),digits=4,
               caption="The relationship clinical response and EF across
  individuals (\\Delta MADRS ~ EF + Age + ECTnum + Site)")

  print(mt.asc,type="org")

#+END_SRC

#+RESULTS:
#+CAPTION: The relationship clinical response and EF across individuals (\Delta MADRS ~ EF + Age + ECTnum + Site)
|    | roi                                               | t_EF    | p_EF   | t_Age  | t_ECTnum |
|----+---------------------------------------------------+---------+--------+--------+----------|
| 1  | \Delta MADRS ~ EF_Left.Cerebellum.Cortex          | 0.5911  | 0.5554 | 2.8958 | -3.0886  |
| 2  | \Delta MADRS ~ EF_Left.Thalamus.Proper            | 0.7565  | 0.4506 | 2.9212 | -3.0857  |
| 3  | \Delta MADRS ~ EF_Left.Caudate                    | 0.1407  | 0.8883 | 2.7672 | -3.0888  |
| 4  | \Delta MADRS ~ EF_Left.Putamen                    | 0.5994  | 0.5498 | 2.8943 | -3.0858  |
| 5  | \Delta MADRS ~ EF_Left.Pallidum                   | 0.8604  | 0.3910 | 2.9470 | -3.0750  |
| 6  | \Delta MADRS ~ EF_Brain.Stem                      | 0.6489  | 0.5174 | 2.8982 | -3.0561  |
| 7  | \Delta MADRS ~ EF_Left.Hippocampus                | 0.8988  | 0.3702 | 2.9636 | -3.0342  |
| 8  | \Delta MADRS ~ EF_Left.Amygdala                   | 0.8849  | 0.3776 | 2.9681 | -3.0528  |
| 9  | \Delta MADRS ~ EF_Left.Accumbens.area             | 0.6629  | 0.5084 | 2.8936 | -3.1124  |
| 10 | \Delta MADRS ~ EF_Left.VentralDC                  | 0.6340  | 0.5271 | 2.9056 | -3.0498  |
| 11 | \Delta MADRS ~ EF_Right.Cerebellum.Cortex         | 0.3516  | 0.7256 | 2.8562 | -3.0940  |
| 12 | \Delta MADRS ~ EF_Right.Thalamus.Proper           | 0.6640  | 0.5077 | 2.8529 | -3.0964  |
| 13 | \Delta MADRS ~ EF_Right.Caudate                   | 0.8166  | 0.4155 | 2.7989 | -3.0779  |
| 14 | \Delta MADRS ~ EF_Right.Putamen                   | 0.7897  | 0.4310 | 2.8274 | -3.0525  |
| 15 | \Delta MADRS ~ EF_Right.Pallidum                  | 0.7554  | 0.4512 | 2.8359 | -3.0804  |
| 16 | \Delta MADRS ~ EF_Right.Hippocampus               | 0.8233  | 0.4117 | 2.8026 | -3.0201  |
| 17 | \Delta MADRS ~ EF_Right.Amygdala                  | 0.5870  | 0.5581 | 2.8061 | -2.9934  |
| 18 | \Delta MADRS ~ EF_Right.Accumbens.area            | 0.3738  | 0.7091 | 2.7332 | -3.0934  |
| 19 | \Delta MADRS ~ EF_Right.VentralDC                 | 0.4961  | 0.6206 | 2.8569 | -3.0618  |
| 20 | \Delta MADRS ~ EF_ctx.lh.bankssts                 | 0.5426  | 0.5882 | 2.8745 | -3.0649  |
| 21 | \Delta MADRS ~ EF_ctx.lh.caudalanteriorcingulate  | 0.8541  | 0.3945 | 2.7991 | -3.1019  |
| 22 | \Delta MADRS ~ EF_ctx.lh.caudalmiddlefrontal      | 1.6153  | 0.1084 | 2.9058 | -3.0231  |
| 23 | \Delta MADRS ~ EF_ctx.lh.cuneus                   | 0.9309  | 0.3534 | 2.9255 | -3.0206  |
| 24 | \Delta MADRS ~ EF_ctx.lh.entorhinal               | 0.5946  | 0.5530 | 2.8601 | -3.1275  |
| 25 | \Delta MADRS ~ EF_ctx.lh.fusiform                 | 0.2980  | 0.7662 | 2.8459 | -3.0907  |
| 26 | \Delta MADRS ~ EF_ctx.lh.inferiorparietal         | 1.0851  | 0.2796 | 2.9171 | -3.0239  |
| 27 | \Delta MADRS ~ EF_ctx.lh.inferiortemporal         | 0.3270  | 0.7441 | 2.8518 | -3.0833  |
| 28 | \Delta MADRS ~ EF_ctx.lh.isthmuscingulate         | 1.2333  | 0.2195 | 2.9969 | -2.9874  |
| 29 | \Delta MADRS ~ EF_ctx.lh.lateraloccipital         | 0.4287  | 0.6688 | 2.8674 | -3.0807  |
| 30 | \Delta MADRS ~ EF_ctx.lh.lateralorbitofrontal     | 0.9777  | 0.3298 | 2.9416 | -3.0362  |
| 31 | \Delta MADRS ~ EF_ctx.lh.lingual                  | -0.3531 | 0.7245 | 2.8298 | -3.1181  |
| 32 | \Delta MADRS ~ EF_ctx.lh.medialorbitofrontal      | 1.0563  | 0.2926 | 2.8343 | -2.9631  |
| 33 | \Delta MADRS ~ EF_ctx.lh.middletemporal           | 0.8938  | 0.3729 | 2.9696 | -3.0696  |
| 34 | \Delta MADRS ~ EF_ctx.lh.parahippocampal          | 0.6632  | 0.5082 | 2.8638 | -3.0749  |
| 35 | \Delta MADRS ~ EF_ctx.lh.paracentral              | 1.7388  | 0.0842 | 2.6519 | -3.0613  |
| 36 | \Delta MADRS ~ EF_ctx.lh.parsopercularis          | 0.7013  | 0.4843 | 2.9014 | -3.0782  |
| 37 | \Delta MADRS ~ EF_ctx.lh.parsorbitalis            | -0.2901 | 0.7722 | 2.6839 | -3.1086  |
| 38 | \Delta MADRS ~ EF_ctx.lh.parstriangularis         | 0.4616  | 0.6451 | 2.8729 | -3.0903  |
| 39 | \Delta MADRS ~ EF_ctx.lh.pericalcarine            | -0.3150 | 0.7532 | 2.7475 | -3.1151  |
| 40 | \Delta MADRS ~ EF_ctx.lh.postcentral              | 1.3784  | 0.1702 | 2.7424 | -3.0058  |
| 41 | \Delta MADRS ~ EF_ctx.lh.posteriorcingulate       | 1.8737  | 0.0630 | 2.4826 | -2.9605  |
| 42 | \Delta MADRS ~ EF_ctx.lh.precentral               | 1.2363  | 0.2183 | 2.8101 | -3.0200  |
| 43 | \Delta MADRS ~ EF_ctx.lh.precuneus                | 1.7816  | 0.0769 | 2.9329 | -2.9294  |
| 44 | \Delta MADRS ~ EF_ctx.lh.rostralanteriorcingulate | 0.4875  | 0.6266 | 2.8769 | -3.0625  |
| 45 | \Delta MADRS ~ EF_ctx.lh.rostralmiddlefrontal     | 0.7272  | 0.4683 | 2.9169 | -3.0548  |
| 46 | \Delta MADRS ~ EF_ctx.lh.superiorfrontal          | 1.7150  | 0.0885 | 2.8632 | -3.0686  |
| 47 | \Delta MADRS ~ EF_ctx.lh.superiorparietal         | 1.7681  | 0.0791 | 2.7671 | -3.0394  |
| 48 | \Delta MADRS ~ EF_ctx.lh.superiortemporal         | 0.9419  | 0.3478 | 2.9896 | -3.0830  |
| 49 | \Delta MADRS ~ EF_ctx.lh.supramarginal            | 0.8131  | 0.4175 | 2.8963 | -3.0267  |
| 50 | \Delta MADRS ~ EF_ctx.lh.frontalpole              | 1.7784  | 0.0774 | 3.0466 | -2.9750  |
| 51 | \Delta MADRS ~ EF_ctx.lh.temporalpole             | -0.4641 | 0.6432 | 2.8275 | -3.0898  |
| 52 | \Delta MADRS ~ EF_ctx.lh.transversetemporal       | 0.9223  | 0.3579 | 2.9875 | -3.0618  |
| 53 | \Delta MADRS ~ EF_ctx.rh.bankssts                 | 0.1027  | 0.9184 | 2.8195 | -3.0657  |
| 54 | \Delta MADRS ~ EF_ctx.rh.caudalanteriorcingulate  | 1.1338  | 0.2587 | 2.8861 | -3.1202  |
| 55 | \Delta MADRS ~ EF_ctx.rh.caudalmiddlefrontal      | 0.8728  | 0.3842 | 2.7763 | -3.0787  |
| 56 | \Delta MADRS ~ EF_ctx.rh.cuneus                   | 0.9737  | 0.3318 | 2.9089 | -3.0052  |
| 57 | \Delta MADRS ~ EF_ctx.rh.entorhinal               | 0.4178  | 0.6767 | 2.7677 | -3.0826  |
| 58 | \Delta MADRS ~ EF_ctx.rh.fusiform                 | -0.0251 | 0.9800 | 2.8316 | -3.0866  |
| 59 | \Delta MADRS ~ EF_ctx.rh.inferiorparietal         | 0.4089  | 0.6832 | 2.8434 | -3.0516  |
| 60 | \Delta MADRS ~ EF_ctx.rh.inferiortemporal         | 0.2850  | 0.7760 | 2.8278 | -3.0981  |
| 61 | \Delta MADRS ~ EF_ctx.rh.isthmuscingulate         | 1.1564  | 0.2494 | 2.9613 | -3.0001  |
| 62 | \Delta MADRS ~ EF_ctx.rh.lateraloccipital         | 1.2967  | 0.1968 | 3.0047 | -3.0047  |
| 63 | \Delta MADRS ~ EF_ctx.rh.lateralorbitofrontal     | 0.2584  | 0.7965 | 2.8039 | -3.0458  |
| 64 | \Delta MADRS ~ EF_ctx.rh.lingual                  | 0.1690  | 0.8660 | 2.8354 | -3.0794  |
| 65 | \Delta MADRS ~ EF_ctx.rh.medialorbitofrontal      | 0.9539  | 0.3417 | 2.7991 | -2.9673  |
| 66 | \Delta MADRS ~ EF_ctx.rh.middletemporal           | -0.0044 | 0.9965 | 2.8248 | -3.0966  |
| 67 | \Delta MADRS ~ EF_ctx.rh.parahippocampal          | -0.1492 | 0.8816 | 2.8609 | -3.0761  |
| 68 | \Delta MADRS ~ EF_ctx.rh.paracentral              | 1.6563  | 0.0998 | 2.5742 | -3.0121  |
| 69 | \Delta MADRS ~ EF_ctx.rh.parsopercularis          | 0.5681  | 0.5708 | 2.8025 | -3.0427  |
| 70 | \Delta MADRS ~ EF_ctx.rh.parsorbitalis            | -1.3677 | 0.1735 | 2.4676 | -3.3135  |
| 71 | \Delta MADRS ~ EF_ctx.rh.parstriangularis         | 0.0660  | 0.9475 | 2.8333 | -3.0937  |
| 72 | \Delta MADRS ~ EF_ctx.rh.pericalcarine            | 0.6869  | 0.4932 | 2.9179 | -3.0338  |
| 73 | \Delta MADRS ~ EF_ctx.rh.postcentral              | 0.8297  | 0.4081 | 2.6889 | -3.0644  |
| 74 | \Delta MADRS ~ EF_ctx.rh.posteriorcingulate       | 2.0097  | 0.0463 | 2.4935 | -2.9198  |
| 75 | \Delta MADRS ~ EF_ctx.rh.precentral               | 0.4018  | 0.6884 | 2.7256 | -3.0819  |
| 76 | \Delta MADRS ~ EF_ctx.rh.precuneus                | 1.6233  | 0.1067 | 2.8070 | -2.9277  |
| 77 | \Delta MADRS ~ EF_ctx.rh.rostralanteriorcingulate | 0.5211  | 0.6031 | 2.8836 | -3.0069  |
| 78 | \Delta MADRS ~ EF_ctx.rh.rostralmiddlefrontal     | 0.1262  | 0.8997 | 2.8358 | -3.0797  |
| 79 | \Delta MADRS ~ EF_ctx.rh.superiorfrontal          | 1.5330  | 0.1274 | 2.7144 | -3.1191  |
| 80 | \Delta MADRS ~ EF_ctx.rh.superiorparietal         | 0.9670  | 0.3351 | 2.7675 | -3.0314  |
| 81 | \Delta MADRS ~ EF_ctx.rh.superiortemporal         | 0.7561  | 0.4508 | 2.7978 | -3.0734  |
| 82 | \Delta MADRS ~ EF_ctx.rh.supramarginal            | 0.6117  | 0.5417 | 2.8186 | -3.0437  |
| 83 | \Delta MADRS ~ EF_ctx.rh.frontalpole              | 1.7738  | 0.0782 | 2.6474 | -2.9880  |
| 84 | \Delta MADRS ~ EF_ctx.rh.temporalpole             | -0.1891 | 0.8503 | 2.8393 | -3.1030  |
| 85 | \Delta MADRS ~ EF_ctx.rh.transversetemporal       | 0.8436  | 0.4003 | 2.8980 | -2.9848  |


